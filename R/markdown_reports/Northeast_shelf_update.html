<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.545">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Kemberling">
<meta name="dcterms.date" content="2022-06-16">
<meta name="description" content="Temperature tracking for the Northeastern US Continental Shelf Region">

<title>Northeastern US Continental Shelf SST Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Northeast_shelf_update_files/libs/clipboard/clipboard.min.js"></script>
<script src="Northeast_shelf_update_files/libs/quarto-html/quarto.js"></script>
<script src="Northeast_shelf_update_files/libs/quarto-html/popper.min.js"></script>
<script src="Northeast_shelf_update_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Northeast_shelf_update_files/libs/quarto-html/anchor.min.js"></script>
<link href="Northeast_shelf_update_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Northeast_shelf_update_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Northeast_shelf_update_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Northeast_shelf_update_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Northeast_shelf_update_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<link href="Northeast_shelf_update_files/libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="Northeast_shelf_update_files/libs/panelset-0.2.6/panelset.js"></script>
<script src="Northeast_shelf_update_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="Northeast_shelf_update_files/libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="Northeast_shelf_update_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Northeast_shelf_update_files/libs/jquery-1.11.3/jquery.min.js"></script>
<link href="Northeast_shelf_update_files/libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="Northeast_shelf_update_files/libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="Northeast_shelf_update_files/libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Northeast_shelf_update_files/libs/plotly-main-1.57.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Northeastern US Continental Shelf SST Report</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    <p>Temperature tracking for the Northeastern US Continental Shelf Region</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <a href="https://github.com/adamkemberling">Adam Kemberling</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Gulf of Maine Research Institute
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 16, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">

</div>
<div class="cell-output-display">

<style type="text/css">/********** GMRI Rmarkdown Core Style Sheet - Do Not Modify!!! **********/


/********** Begin Style Sheet **********/

/* Avenir Font from Fonts.com for GMRI Branding */

@import url("http://fast.fonts.net/t/1.css?apiType=css&projectid=806f61f6-d695-4965-a878-820b50bc0269");
    @font-face{
        font-family:"Avenir LT W01_35 Light1475496";
        src:url("Fonts/0078f486-8e52-42c0-ad81-3c8d3d43f48e.woff2") format("woff2"),url("Fonts/908c4810-64db-4b46-bb8e-823eb41f68c0.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_35 Light_1475502";
        src:url("Fonts/a59168c1-917d-4de9-a244-0316c057c357.woff2") format("woff2"),url("Fonts/6dc0e7d8-9284-44e1-8f05-984a41daa3a4.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_45 Book1475508";
        src:url("Fonts/065a6b14-b2cc-446e-9428-271c570df0d9.woff2") format("woff2"),url("Fonts/65d75eb0-2601-4da5-a9a4-9ee67a470a59.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_45 Book O1475514";
        src:url("Fonts/476612d9-282d-4f76-95cd-b4dd31e7ed21.woff2") format("woff2"),url("Fonts/f1ebae2b-5296-4244-8771-5f40e60a564a.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_55 Roman1475520";
        src:url("Fonts/b290e775-e0f9-4980-914b-a4c32a5e3e36.woff2") format("woff2"),url("Fonts/4b978f72-bb48-46c3-909a-2a8cd2f8819c.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_55 Obliqu1475526";
        src:url("Fonts/1a7173fa-062b-49ad-9915-bc57d3bfc1f5.woff2") format("woff2"),url("Fonts/cdda031e-26e9-4269-83d1-5a218caa10db.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_65 Medium1475532";
        src:url("Fonts/17b90ef5-b63f-457b-a981-503bb7afe3c0.woff2") format("woff2"),url("Fonts/c9aeeabd-dd65-491d-b4be-3e0db9ae47a0.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_65 Medium1475538";
        src:url("Fonts/deb5e718-7abb-4df3-9365-edfa95317090.woff2") format("woff2"),url("Fonts/04801919-17ee-4c6b-8b17-eb1965cb3ed6.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_85 Heavy1475544";
        src:url("Fonts/d513e15e-8f35-4129-ad05-481815e52625.woff2") format("woff2"),url("Fonts/61bd362e-7162-46bd-b67e-28f366c4afbe.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_85 Heavy_1475550";
        src:url("Fonts/3c210c80-960f-4684-850b-25390b4d08af.woff2") format("woff2"),url("Fonts/cb5c71ad-e582-4d00-929c-67fbfaeb1c27.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_95 Black1475556";
        src:url("Fonts/c78eb7af-a1c8-4892-974b-52379646fef4.woff2") format("woff2"),url("Fonts/75b36c58-2a02-4057-a537-09af0832ae46.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_95 Black_1475562";
        src:url("Fonts/a2477e08-09d9-4d4b-97a9-23a1e22cb44c.woff2") format("woff2"),url("Fonts/19d12bba-92b1-43ad-9bab-cd36a4195c2a.woff") format("woff");
    }





/* PRE-Avenir Fonts: Lato + Raleway font import from google fonts */
@import url('https://fonts.googleapis.com/css?family=Lato');
@import url('https://fonts.googleapis.com/css?family=Raleway&display=swap');

/* add font families as needed: font-family: 'Lato', sans-serif; */


/* Level 1 Headers */
h1 { text-align: left;
     margin: 10px 0 15px 0; 
     font-size: 38px; 
     font-family: Avenir;
} 


/* Headers 2 - 6 */
h2, h3, h4, h5, h6 { 
    color: #333333; 
    margin: 20px 0 5px 0; 
    text-align: left;
    font-family: Avenir;}


/* Sizing/font For Each Header Type */
h2 { font-size: 24px; }
h3 { font-size: 20px; }
h4 { font-size: 18px; }
h5 { font-size: 16px; font-weight: normal; color: #3069aa; text-decoration: underline;}
h6 { font-size: 14px; font-weight: normal; color: #3069aa; }


/* Paragraph Text */
p, ol { margin-top: 10px; 
    font-family: 'Raleway', sans-serif;}


/* Title Author and Date Headers */
h1.title.toc-ignore {margin-top: 10px;}
h4.author, h4.date {
    color: rgb(0,115,109);
    margin-top: 0px; 
    margin-bottom: 5px; 
    font-size: 12px;}



/* Add Spacing Above Headers */
h1, .h1, h2, .h2, h3, .h3 {
    margin-top: 40px;
}


/* Links */
a {
    color: rgb(234,79,18)
}


/***********************************************/


/********  Table of Contents  **********/

/* Highlighted TOC Element */
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    z-index: 2;
    color: #fff;
    background-color: rgb(0,96,138);
    border-color: rgb(0,96,138);
}

/* Default TOC Elements */
.list-group-item, .list-group-item:focus, .list-group-item:hover {
    z-index: 2;
    color: rgb(0,96,138);
    background-color: #fff;
    border-color: rgb(0,96,138);
}


/********  Tab Panels  **********/

/* Navigation Tabs - Highlighted Tabset Pills */
.nav-pills > li.active > a, .nav-pills > li.active > a:hover, .nav-pills > li.active > a:focus {
    color: #fff;
    background-color: rgb(0,115,109) ;
    }

/* Navigation Tabs - Default Tabset Pills */
.nav-pills > li > a, .nav-pills > li > a:hover, .nav-pills > li > a:focus {
    color: rgb(0,115,109);
    background-color: #fff;
    }


/* Second Level Tabs - Active */
.nav.nav-tabs > li.active  > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
    color: #fff;
    background-color: rgb(83,83,83) ;
    }

/* Second Level Tabs - Inactive */
.nav.nav-tabs > li  > a, .nav-tabs > li > a:hover, .nav-tabs > li > a:focus {
    color: rgb(83,83,83);
    background-color: #fff;
    }



/********** End Core Style Sheet **********/
/********** End Core Style Sheet **********/



</style>
</div>
</div>
<section id="northeastern-us-shelf-region-2022-sea-surface-temperature" class="level1">
<h1>Northeastern US Shelf Region 2022: Sea Surface Temperature</h1>
<p>This report was created to track the sea surface temperature regimes for the Northeastern US continental shelf, an area sampled as part of the NMFS Northeast trawl survey.</p>
<p>Satellite sea surface temperature data used was obtained from the National Center for Environmental Information (NCEI). With all maps and figures displaying <a href="https://www.ncdc.noaa.gov/oisst">NOAA’s Optimum Interpolation Sea Surface Temperature Data</a>.</p>
<p><strong>DISCLAIMER:</strong> Any data within 2-weeks of the current date are subject to revision and may change. Please use caution when reporting information that contains these values.</p>
<section id="northeastern-us-shelf-region-on-a-map" class="level3">
<h3 class="anchored" data-anchor-id="northeastern-us-shelf-region-on-a-map">Northeastern US Shelf Region On a Map</h3>
<p>Whenever discussing the Northeastern US Shelf Region in this report, we refer to the following spatial extent displayed below. The coordinates of this bounding box are the same coordinates used to clip the sea surface temperature data.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="temperature-history" class="level1">
<h1>1: Temperature History</h1>
<p>Using the coordinates shown above we can create an area-specific temperature history. For any day of the year since <strong>September of 1981</strong>, data is available to calculate the average sea surface temperature within that area for each day.</p>
<p>Additionally, we can compare observed temperatures against the expected conditions based on a climatology using a specified reference period. The standard reference period used for the climatology here is 1982-2011, a 30-year period.</p>
<div class="cell">

</div>
<section id="climatological-patterns-of-the-northeastern-us-shelf-region" class="level2">
<h2 class="anchored" data-anchor-id="climatological-patterns-of-the-northeastern-us-shelf-region">Climatological Patterns of the Northeastern US Shelf Region</h2>
<p>Daily climatologies are a record of daily averages based on the day of the year. They record what the average temperature has been for each day of the year, across the specified reference period.</p>
<p>In addition to the daily average, we also look at how variable temperatures are. This variability is used to benchmark how “rare” extreme events are to determine whether they are part of a natural cycle or not.</p>
<p>Common benchmarks for extreme events are the 10th and 90th percentile. Temperatures above the 90th percentile are among the hottest 10% of days in the reference period. Temperatures below the 10th percentile correspond to the coldest 10%. The remaining 80% of days fall somewhere in-between and showcase the range of temperatures we might expect to occur given the natural variability of the climate.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="working-in-anomalies" class="level3">
<h3 class="anchored" data-anchor-id="working-in-anomalies">Working in Anomalies</h3>
<p>Using the climatology as a reference, we can see hot much “hotter” or “colder” a given day is than what we would on average expect. This difference from the average is what we call anomalies.</p>
<p>In the table below, <code>Sea Surface Temperature</code> is the mean temperature observed for that date averaged across all cells within the area. <code>Climate Avg.</code> &amp; <code>Climate SD</code> are the climate means and standard deviations for a 1982-2011 climatology. <code>Temperature Anomaly</code> is the daily observed sea surface temperature minus the climate mean.</p>
<p>In this way a <code>Temperature Anomaly</code> is just: How much hotter or colder is it than the average temperature for that day.</p>
<div class="cell">
<div class="cell-output-display">

<div id="shdlmtmifm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#shdlmtmifm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#shdlmtmifm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#shdlmtmifm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#shdlmtmifm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#shdlmtmifm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#shdlmtmifm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#shdlmtmifm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#shdlmtmifm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#shdlmtmifm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#shdlmtmifm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#shdlmtmifm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#shdlmtmifm .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#shdlmtmifm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#shdlmtmifm .gt_from_md > :first-child {
  margin-top: 0;
}

#shdlmtmifm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#shdlmtmifm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#shdlmtmifm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#shdlmtmifm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#shdlmtmifm .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#shdlmtmifm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#shdlmtmifm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#shdlmtmifm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#shdlmtmifm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#shdlmtmifm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#shdlmtmifm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#shdlmtmifm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#shdlmtmifm .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#shdlmtmifm .gt_left {
  text-align: left;
}

#shdlmtmifm .gt_center {
  text-align: center;
}

#shdlmtmifm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#shdlmtmifm .gt_font_normal {
  font-weight: normal;
}

#shdlmtmifm .gt_font_bold {
  font-weight: bold;
}

#shdlmtmifm .gt_font_italic {
  font-style: italic;
}

#shdlmtmifm .gt_super {
  font-size: 65%;
}

#shdlmtmifm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="5" class="gt_heading gt_title gt_font_normal" style=""><strong>Northeastern US Shelf Region - Regional Sea Surface Temperature</strong></th>
    </tr>
    <tr>
      <th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Temperature Unit: Celsius</th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Sea Surface Temperature</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Day of Year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Climate Avg.</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Temperature Anomaly</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">2022-06-03</td>
<td class="gt_row gt_right">13.55</td>
<td class="gt_row gt_right">155</td>
<td class="gt_row gt_right">12.23</td>
<td class="gt_row gt_right">1.32</td></tr>
    <tr><td class="gt_row gt_left">2022-06-04</td>
<td class="gt_row gt_right">13.63</td>
<td class="gt_row gt_right">156</td>
<td class="gt_row gt_right">12.34</td>
<td class="gt_row gt_right">1.29</td></tr>
    <tr><td class="gt_row gt_left">2022-06-05</td>
<td class="gt_row gt_right">13.83</td>
<td class="gt_row gt_right">157</td>
<td class="gt_row gt_right">12.44</td>
<td class="gt_row gt_right">1.39</td></tr>
    <tr><td class="gt_row gt_left">2022-06-06</td>
<td class="gt_row gt_right">14.51</td>
<td class="gt_row gt_right">158</td>
<td class="gt_row gt_right">12.52</td>
<td class="gt_row gt_right">1.99</td></tr>
    <tr><td class="gt_row gt_left">2022-06-07</td>
<td class="gt_row gt_right">14.82</td>
<td class="gt_row gt_right">159</td>
<td class="gt_row gt_right">12.70</td>
<td class="gt_row gt_right">2.12</td></tr>
    <tr><td class="gt_row gt_left">2022-06-08</td>
<td class="gt_row gt_right">14.82</td>
<td class="gt_row gt_right">160</td>
<td class="gt_row gt_right">12.89</td>
<td class="gt_row gt_right">1.93</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="5"><em>Data Source: NOAA OISSTv2 Daily Sea Surface Temperature Data.</em></td>
    </tr>
    <tr>
      <td class="gt_sourcenote" colspan="5"><em>Climatology Reference Period: 1982-2011.</em></td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
</section>
<section id="detecting-long-term-changes" class="level3">
<h3 class="anchored" data-anchor-id="detecting-long-term-changes">Detecting Long-Term Changes</h3>
<p>One reason we go through this trouble of calculating climatologies and anomalies is to set expectations around how much we expect things to naturally vary, and to detect when things fall outside that range.</p>
<p>In the case of the Northeastern US Shelf Region we are now consistently outside of the range of temperatures normally expected from 1982-2011. The following plot colors the monthly average by how far temperatures are from the climatological average. Blue colors represent a month that was cooler than average, with red indicating a warmer than average month.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/temp%20stripes-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="warming-rates" class="level3 tabset">
<h3 class="tabset anchored" data-anchor-id="warming-rates">Warming Rates</h3>
<p>Seeing this change towards a warmer climate, it is then natural to ask how rapidly the change is happening. This is where we turn to warming rates. The warming trends below were calculated using all the available data for complete years beginning with 1982 through the end of 2021.</p>
<p>The overlaid trend lines then track how warming has increased with time. A dotted line has been included to show how the global average temperature has changed during the same period.</p>
<section id="warming-trends" class="level4">
<h4 class="anchored" data-anchor-id="warming-trends">Warming Trends</h4>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/annual%20trend%20plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Region Shift in Ocean Circulation</strong></p>
<p>Beginning around 2008, temperature in the region swung upward, and since 2010 most yearly temperatures have been over 1 degree above the hematological average of the previous 30-years. With some years experiencing temperatures more than 2 degrees C above that average.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The magnitude of this regime shift was 1.05C, or 1.9F. Bringing average yearly temperatures up from the 30-year average of 11.87C to 12.93C, or 53.37F to 55.27F.</p>
</section>
<section id="seasonal-patterns" class="level4">
<h4 class="anchored" data-anchor-id="seasonal-patterns">Seasonal Patterns</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="overall-temperature-increase" class="level4">
<h4 class="anchored" data-anchor-id="overall-temperature-increase">Overall Temperature Increase</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="marine-heatwaves" class="level3 tabset">
<h3 class="tabset anchored" data-anchor-id="marine-heatwaves">Marine Heatwaves</h3>
<p>A marine heatwave is defined as a situation when seawater temperatures exceeds a seasonally-varying threshold (usually the 90th percentile) for at least 5 consecutive days. Successive heatwaves with gaps of 2 days or less are considered part of the same event. The heatwave threshold used below was 90%. The heatwave history for Northeastern US Shelf Region is displayed below:</p>
<p><strong>Note:</strong> For the figures below heatwave events were determined using the methods of Hobday et al.&nbsp;2016 and implemented using the R package <a href="https://robwschlegel.github.io/heatwaveR/">{heatwaveR}</a>.</p>
<section id="heatwave-events" class="level4">
<h4 class="anchored" data-anchor-id="heatwave-events">Heatwave Events</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="heatwave-trends" class="level4">
<h4 class="anchored" data-anchor-id="heatwave-trends">Heatwave Trends</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="observations" class="level1">
<h1>2: 2022 Observations</h1>
<section id="temperatures-of-the-last-full-year-interactive" class="level3">
<h3 class="anchored" data-anchor-id="temperatures-of-the-last-full-year-interactive">Temperatures of the Last Full Year (Interactive)</h3>
<p>Daily temperatures for the last 365 days are displayed below with reference to how they fall against the marine heatwave and cold spell thresholds.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-c2a931752ae4f30d7598" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c2a931752ae4f30d7598">{"x":{"visdat":{"12a394aa5613e":["function () ","plotlyVisDat"]},"cur_data":"12a394aa5613e","attrs":{"12a394aa5613e":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Sea Surface Temperature","mode":"lines","type":"scatter","line":{"color":"rgb(65, 105, 225)","width":2},"inherit":true},"12a394aa5613e.1":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"MHW Threshold","mode":"lines","type":"scatter","line":{"color":"rgb(205, 91, 69)","width":1,"dash":"dot"},"inherit":true},"12a394aa5613e.2":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Daily Climatology","mode":"lines","type":"scatter","line":{"color":"rgb(102, 102, 102)","width":3,"dash":"dash"},"inherit":true},"12a394aa5613e.3":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"MCS Threshold","mode":"lines","type":"scatter","line":{"color":"rgb(135, 206, 235)","width":1,"dash":"dot"},"inherit":true},"12a394aa5613e.4":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Marine Heatwave Event","mode":"lines","type":"scatter","line":{"color":"rgb(139, 0, 0)","width":2},"inherit":true},"12a394aa5613e.5":{"x":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"name":"Marine Cold Spell Event ","mode":"lines","type":"scatter","line":{"color":"rgb(65, 105, 225)","width":2},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"yaxis":{"domain":[0,1],"automargin":true,"title":"Temperature (degrees C)"},"legend":{"orientation":"h"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2021-01-01","2021-01-02","2021-01-03","2021-01-04","2021-01-05","2021-01-06","2021-01-07","2021-01-08","2021-01-09","2021-01-10","2021-01-11","2021-01-12","2021-01-13","2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23","2021-02-24","2021-02-25","2021-02-26","2021-02-27","2021-02-28","2021-03-01","2021-03-02","2021-03-03","2021-03-04","2021-03-05","2021-03-06","2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20","2021-03-21","2021-03-22","2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15","2021-04-16","2021-04-17","2021-04-18","2021-04-19","2021-04-20","2021-04-21","2021-04-22","2021-04-23","2021-04-24","2021-04-25","2021-04-26","2021-04-27","2021-04-28","2021-04-29","2021-04-30","2021-05-01","2021-05-02","2021-05-03","2021-05-04","2021-05-05","2021-05-06","2021-05-07","2021-05-08","2021-05-09","2021-05-10","2021-05-11","2021-05-12","2021-05-13","2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30","2021-05-31","2021-06-01","2021-06-02","2021-06-03","2021-06-04","2021-06-05","2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05","2021-07-06","2021-07-07","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-13","2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30","2021-07-31","2021-08-01","2021-08-02","2021-08-03","2021-08-04","2021-08-05","2021-08-06","2021-08-07","2021-08-08","2021-08-09","2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03","2021-09-04","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14","2021-10-15","2021-10-16","2021-10-17","2021-10-18","2021-10-19","2021-10-20","2021-10-21","2021-10-22","2021-10-23","2021-10-24","2021-10-25","2021-10-26","2021-10-27","2021-10-28","2021-10-29","2021-10-30","2021-10-31","2021-11-01","2021-11-02","2021-11-03","2021-11-04","2021-11-05","2021-11-06","2021-11-07","2021-11-08","2021-11-09","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-14","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-19","2021-11-20","2021-11-21","2021-11-22","2021-11-23","2021-11-24","2021-11-25","2021-11-26","2021-11-27","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-02","2021-12-03","2021-12-04","2021-12-05","2021-12-06","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-12","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-17","2021-12-18","2021-12-19","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31"],"y":[9.11852264404297,9.07192516326904,9.13490772247314,9.0917329788208,8.94898128509521,8.84127521514893,8.78260612487793,8.81276416778564,8.79383945465088,8.65420627593994,8.63167762756348,8.57177448272705,8.62498664855957,8.63949203491211,8.71224308013916,8.71546268463135,8.62837886810303,8.67225933074951,8.78775787353516,8.70401287078857,8.48922824859619,8.41090106964111,8.38719367980957,8.30350494384766,8.28661727905273,8.11338520050049,7.97213697433472,7.88549947738647,7.80356216430664,7.72993421554565,7.64998722076416,7.7422399520874,7.76347541809082,7.68549871444702,7.62804460525513,7.37471008300781,7.31167697906494,7.22169876098633,6.96164846420288,6.86123847961426,6.8663501739502,6.87070465087891,6.82513380050659,6.72320556640625,6.64764833450317,6.65541934967041,6.92770433425903,6.98187255859375,6.94456577301025,6.92743444442749,6.79479789733887,6.53643178939819,6.44363975524902,6.28765201568604,6.28064584732056,6.19218158721924,6.04993391036987,6.03900671005249,6.29723262786865,6.36386108398438,6.35205459594727,6.45510530471802,6.4085373878479,6.26940393447876,6.16341924667358,6.01734638214111,5.92328023910522,5.94240665435791,6.10737371444702,6.36843538284302,6.72554445266724,6.66021108627319,6.64970922470093,6.49181127548218,6.17545557022095,6.18787288665771,6.27270746231079,6.19197463989258,6.14900302886963,6.18944978713989,6.3730411529541,6.63554048538208,6.87098836898804,7.15458965301514,7.0654411315918,6.93267345428467,6.80781698226929,6.84691381454468,7.03539752960205,7.21804666519165,7.26168155670166,6.98310804367065,6.92679071426392,6.9091944694519,6.96913719177246,7.11034631729126,7.37439203262329,7.67831563949585,7.89472341537476,8.083984375,8.17249774932861,7.99165868759155,7.61568212509155,7.63175439834595,7.55266809463501,7.50705623626709,7.50653600692749,8.03592967987061,8.19387340545654,8.26993274688721,8.45516777038574,8.20516872406006,7.59661674499512,7.62897729873657,7.7679386138916,7.82051277160645,8.03540992736816,8.3219051361084,8.58765697479248,8.51616096496582,8.79305553436279,9.19408798217773,9.5290002822876,9.62689208984375,9.43536186218262,9.60948181152344,9.75387001037598,9.76159954071045,9.87945938110352,10.005633354187,10.0067481994629,10.1151399612427,10.3828411102295,10.6801910400391,11.1952352523804,11.6427459716797,12.2267093658447,12.6055564880371,12.5560464859009,12.6658115386963,12.7438554763794,12.997031211853,12.9999408721924,12.5859880447388,12.4967994689941,12.7307796478271,13.1244029998779,13.2610235214233,13.0793342590332,12.8586416244507,12.8236446380615,12.7885408401489,12.8163175582886,12.9705305099487,13.00843334198,13.2943077087402,14.6243419647217,15.3000898361206,15.4125080108643,15.6645622253418,16.0080165863037,15.9171209335327,15.3487424850464,15.3591709136963,15.7051038742065,16.0243091583252,16.5155181884766,16.6427192687988,16.7237758636475,16.9374465942383,17.1644134521484,17.7055606842041,17.9937572479248,17.511100769043,17.3202438354492,17.5893611907959,17.8269138336182,17.9963855743408,18.7609252929688,19.3711967468262,19.5692749023438,19.6127243041992,19.3981647491455,18.9093685150146,18.5936660766602,18.1641082763672,18.3617877960205,18.5766544342041,18.8005313873291,18.6847038269043,18.3930740356445,18.5405807495117,18.803617477417,18.9805488586426,20.1304988861084,20.5480899810791,20.2804412841797,20.2796669006348,20.4419651031494,20.3985004425049,20.3409957885742,20.4126720428467,20.3738861083984,20.3899936676025,20.5528926849365,20.4931488037109,20.432580947876,20.6694278717041,20.775484085083,20.7435684204102,20.2348651885986,19.9468173980713,19.9785957336426,20.0830669403076,20.2329158782959,20.1523361206055,20.0949172973633,20.3317813873291,20.650972366333,20.7465858459473,20.8070163726807,20.9464054107666,21.3332099914551,22.0618457794189,22.2094249725342,22.2472877502441,22.2901058197021,21.9405460357666,21.8638210296631,21.8379535675049,21.5776748657227,21.6463203430176,21.8719177246094,22.0385513305664,21.8664131164551,21.6876049041748,21.7484321594238,22.0744609832764,22.3965473175049,22.3451614379883,21.7711639404297,21.5734310150146,21.7161769866943,21.8078956604004,21.0150909423828,20.0285797119141,19.7812957763672,19.703577041626,19.8889446258545,20.0749397277832,20.2172241210938,20.2950592041016,20.1225070953369,19.9214973449707,19.8866539001465,19.8311004638672,19.898006439209,20.0595512390137,20.1366786956787,20.2095699310303,20.336540222168,20.2903099060059,20.1229133605957,19.9763107299805,19.9281558990479,20.0528221130371,20.1933269500732,20.1863670349121,20.0910243988037,19.8714389801025,19.800422668457,19.639087677002,19.2109375,18.9142417907715,18.7804279327393,18.7456970214844,18.7615585327148,18.7741622924805,18.7405834197998,18.7722797393799,18.7211036682129,18.6289920806885,18.4753017425537,18.4267139434814,18.4153251647949,18.3357849121094,18.455322265625,18.4758129119873,18.4339332580566,18.202075958252,17.8932437896729,17.417064666748,17.0632972717285,17.0004329681396,17.0379428863525,16.9497108459473,16.7845630645752,16.7014694213867,16.6359996795654,16.3930435180664,16.2924423217773,16.085205078125,15.8699102401733,15.6584796905518,15.5297718048096,15.3793573379517,15.2355337142944,15.114725112915,14.875789642334,14.7283191680908,14.6113471984863,14.5513334274292,14.5182399749756,14.3858041763306,14.2505683898926,14.2074241638184,14.131329536438,14.0319042205811,13.9059524536133,13.7011919021606,13.5346336364746,13.4862546920776,13.4513969421387,13.2983798980713,13.1414699554443,13.056357383728,12.892463684082,12.7776107788086,12.6546154022217,12.4923858642578,12.2107391357422,11.9953355789185,11.8810720443726,11.7701549530029,11.6971712112427,11.6462888717651,11.6540393829346,11.5977449417114,11.5673236846924,11.5472230911255,11.4641151428223,11.3507242202759,11.3389682769775,11.3677196502686,11.2311334609985,11.1660041809082,11.182186126709,11.1458253860474,11.0548715591431,11.0576333999634,11.0651416778564,11.0418930053711,11.0270776748657,10.8833904266357,10.770956993103,10.6502914428711,10.494402885437,10.4503078460693,10.396915435791,10.3672695159912,10.3484525680542,10.3328866958618,10.3458395004272,10.3166437149048,10.2671327590942],"name":"Sea Surface Temperature","mode":"lines","type":"scatter","line":{"color":"rgb(65, 105, 225)","width":2},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021-01-01","2021-01-02","2021-01-03","2021-01-04","2021-01-05","2021-01-06","2021-01-07","2021-01-08","2021-01-09","2021-01-10","2021-01-11","2021-01-12","2021-01-13","2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23","2021-02-24","2021-02-25","2021-02-26","2021-02-27","2021-02-28","2021-03-01","2021-03-02","2021-03-03","2021-03-04","2021-03-05","2021-03-06","2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20","2021-03-21","2021-03-22","2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15","2021-04-16","2021-04-17","2021-04-18","2021-04-19","2021-04-20","2021-04-21","2021-04-22","2021-04-23","2021-04-24","2021-04-25","2021-04-26","2021-04-27","2021-04-28","2021-04-29","2021-04-30","2021-05-01","2021-05-02","2021-05-03","2021-05-04","2021-05-05","2021-05-06","2021-05-07","2021-05-08","2021-05-09","2021-05-10","2021-05-11","2021-05-12","2021-05-13","2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30","2021-05-31","2021-06-01","2021-06-02","2021-06-03","2021-06-04","2021-06-05","2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05","2021-07-06","2021-07-07","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-13","2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30","2021-07-31","2021-08-01","2021-08-02","2021-08-03","2021-08-04","2021-08-05","2021-08-06","2021-08-07","2021-08-08","2021-08-09","2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03","2021-09-04","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14","2021-10-15","2021-10-16","2021-10-17","2021-10-18","2021-10-19","2021-10-20","2021-10-21","2021-10-22","2021-10-23","2021-10-24","2021-10-25","2021-10-26","2021-10-27","2021-10-28","2021-10-29","2021-10-30","2021-10-31","2021-11-01","2021-11-02","2021-11-03","2021-11-04","2021-11-05","2021-11-06","2021-11-07","2021-11-08","2021-11-09","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-14","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-19","2021-11-20","2021-11-21","2021-11-22","2021-11-23","2021-11-24","2021-11-25","2021-11-26","2021-11-27","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-02","2021-12-03","2021-12-04","2021-12-05","2021-12-06","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-12","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-17","2021-12-18","2021-12-19","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31"],"y":[9.6946,9.6169,9.5364,9.4539,9.3712,9.2898,9.2068,9.1242,9.0418,8.957,8.8714,8.7861,8.7043,8.6236,8.5429,8.4618,8.3833,8.306,8.2293,8.1526,8.0768,8.0025,7.9286,7.8562,7.7843,7.7123,7.6396,7.5649,7.4925,7.423,7.3584,7.2937,7.2315,7.1724,7.1167,7.0623,7.0079,6.9567,6.9076,6.8595,6.8153,6.7722,6.7303,6.6896,6.6499,6.6112,6.5755,6.5431,6.513,6.4873,6.4637,6.4412,6.4199,6.3996,6.3801,6.3628,6.347,6.3338,6.3249,6.3094,6.3036,6.3025,6.3032,6.3045,6.3057,6.3068,6.3088,6.3128,6.3178,6.3239,6.3317,6.3415,6.3526,6.3651,6.3792,6.3948,6.4111,6.4277,6.4465,6.467,6.4892,6.513,6.5371,6.5639,6.5924,6.6214,6.6533,6.686,6.7199,6.7585,6.7993,6.8441,6.8899,6.9378,6.9889,7.0416,7.0989,7.1623,7.2262,7.2938,7.3628,7.4336,7.5044,7.5763,7.6495,7.7254,7.8049,7.8844,7.9646,8.0457,8.1306,8.2209,8.3135,8.4095,8.5032,8.5986,8.6953,8.7941,8.8964,8.9995,9.1029,9.2089,9.3153,9.4273,9.5419,9.6571,9.7746,9.8918,10.0069,10.1277,10.2495,10.3811,10.5162,10.6566,10.8012,10.9516,11.1008,11.2489,11.3977,11.5478,11.6968,11.8457,11.9917,12.1387,12.2863,12.438,12.5897,12.7439,12.8981,13.0543,13.2119,13.3697,13.5273,13.6854,13.8445,14.0023,14.1625,14.3266,14.4919,14.6598,14.8246,14.9891,15.1439,15.2956,15.4456,15.5934,15.7362,15.8791,16.0211,16.1657,16.3117,16.4575,16.5994,16.741,16.8821,17.0213,17.1577,17.2935,17.4321,17.5696,17.7045,17.8412,17.975,18.1105,18.2427,18.367,18.4896,18.6071,18.7186,18.8264,18.9277,19.0267,19.1231,19.22,19.3175,19.4135,19.5069,19.5989,19.6894,19.7777,19.8612,19.9414,20.0182,20.0931,20.1635,20.2281,20.2902,20.3526,20.4127,20.4674,20.5207,20.5707,20.6154,20.6585,20.6959,20.7284,20.7584,20.7858,20.8086,20.8268,20.8421,20.8551,20.8655,20.8725,20.8759,20.8735,20.861,20.8428,20.8199,20.7933,20.7643,20.7339,20.7011,20.6661,20.629,20.5914,20.5519,20.51,20.4648,20.4167,20.364,20.3049,20.2427,20.1756,20.1041,20.0307,19.9583,19.8843,19.8108,19.7391,19.6696,19.5999,19.5309,19.4617,19.3906,19.3185,19.2446,19.1727,19.1009,19.0288,18.9548,18.8804,18.8054,18.7291,18.651,18.5706,18.4875,18.4036,18.3187,18.2324,18.1451,18.0573,17.9719,17.8848,17.7975,17.7076,17.6148,17.5188,17.4232,17.3257,17.2264,17.1241,17.0173,16.9078,16.7959,16.6833,16.5702,16.4557,16.3418,16.2276,16.1123,15.9972,15.8818,15.7659,15.6502,15.5355,15.4212,15.3078,15.1963,15.0862,14.9768,14.8633,14.7487,14.6333,14.5194,14.4083,14.3019,14.198,14.0948,13.9923,13.8889,13.788,13.6906,13.5984,13.5079,13.4174,13.3273,13.2379,13.1509,13.0628,12.9764,12.8935,12.8128,12.7324,12.6531,12.5744,12.4982,12.4224,12.3474,12.2739,12.2002,12.1243,12.0525,11.9805,11.9067,11.8338,11.7623,11.6911,11.6208,11.5534,11.4858,11.4189,11.3517,11.2828,11.2143,11.1463,11.0767,11.0076,10.9391,10.8712,10.8034,10.7344,10.6619,10.5882,10.5144,10.439,10.3641,10.2888,10.215,10.1424,10.0685,9.9942,9.9211,9.8466,9.7702],"name":"MHW Threshold","mode":"lines","type":"scatter","line":{"color":"rgb(205, 91, 69)","width":1,"dash":"dot"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021-01-01","2021-01-02","2021-01-03","2021-01-04","2021-01-05","2021-01-06","2021-01-07","2021-01-08","2021-01-09","2021-01-10","2021-01-11","2021-01-12","2021-01-13","2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23","2021-02-24","2021-02-25","2021-02-26","2021-02-27","2021-02-28","2021-03-01","2021-03-02","2021-03-03","2021-03-04","2021-03-05","2021-03-06","2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20","2021-03-21","2021-03-22","2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15","2021-04-16","2021-04-17","2021-04-18","2021-04-19","2021-04-20","2021-04-21","2021-04-22","2021-04-23","2021-04-24","2021-04-25","2021-04-26","2021-04-27","2021-04-28","2021-04-29","2021-04-30","2021-05-01","2021-05-02","2021-05-03","2021-05-04","2021-05-05","2021-05-06","2021-05-07","2021-05-08","2021-05-09","2021-05-10","2021-05-11","2021-05-12","2021-05-13","2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30","2021-05-31","2021-06-01","2021-06-02","2021-06-03","2021-06-04","2021-06-05","2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05","2021-07-06","2021-07-07","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-13","2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30","2021-07-31","2021-08-01","2021-08-02","2021-08-03","2021-08-04","2021-08-05","2021-08-06","2021-08-07","2021-08-08","2021-08-09","2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03","2021-09-04","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14","2021-10-15","2021-10-16","2021-10-17","2021-10-18","2021-10-19","2021-10-20","2021-10-21","2021-10-22","2021-10-23","2021-10-24","2021-10-25","2021-10-26","2021-10-27","2021-10-28","2021-10-29","2021-10-30","2021-10-31","2021-11-01","2021-11-02","2021-11-03","2021-11-04","2021-11-05","2021-11-06","2021-11-07","2021-11-08","2021-11-09","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-14","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-19","2021-11-20","2021-11-21","2021-11-22","2021-11-23","2021-11-24","2021-11-25","2021-11-26","2021-11-27","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-02","2021-12-03","2021-12-04","2021-12-05","2021-12-06","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-12","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-17","2021-12-18","2021-12-19","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31"],"y":[8.338,8.2628,8.1878,8.113,8.0386,7.9648,7.8913,7.8179,7.7446,7.6714,7.5983,7.5259,7.4544,7.384,7.3147,7.2468,7.1799,7.1143,7.0501,6.9872,6.9258,6.8657,6.8067,6.7487,6.6917,6.6357,6.5808,6.5269,6.4742,6.4229,6.3729,6.3243,6.2773,6.2318,6.1879,6.1452,6.1036,6.0633,6.0244,5.9869,5.9507,5.9158,5.8819,5.8487,5.8163,5.7846,5.754,5.7245,5.6962,5.669,5.6428,5.6177,5.5937,5.571,5.5499,5.5305,5.5127,5.4962,5.4808,5.4532,5.441,5.4299,5.4199,5.411,5.4031,5.3964,5.3912,5.388,5.3867,5.3873,5.3899,5.3947,5.4017,5.4111,5.4227,5.4363,5.4518,5.469,5.4877,5.508,5.5301,5.5538,5.5792,5.6061,5.6344,5.6644,5.6961,5.7298,5.7659,5.8045,5.8459,5.8905,5.9377,5.9877,6.0403,6.0957,6.1539,6.2146,6.2773,6.3419,6.4083,6.4765,6.5462,6.6177,6.6913,6.7672,6.8451,6.9251,7.0072,7.0917,7.1784,7.2671,7.3575,7.4496,7.5436,7.6392,7.7362,7.8344,7.9337,8.034,8.1354,8.2379,8.3415,8.4467,8.5534,8.6612,8.77,8.8802,8.992,9.1059,9.2224,9.3412,9.4621,9.5849,9.7088,9.8335,9.9591,10.086,10.2142,10.3437,10.474,10.6052,10.7372,10.8702,11.0045,11.1405,11.2783,11.4184,11.5609,11.7058,11.853,12.0018,12.1522,12.3038,12.4563,12.6097,12.7644,12.9204,13.0772,13.2341,13.3905,13.546,13.7008,13.855,14.0092,14.1636,14.3182,14.4724,14.6262,14.7797,14.9331,15.0862,15.2392,15.392,15.5443,15.6958,15.8463,15.9954,16.1429,16.2885,16.4315,16.572,16.7098,16.8447,16.9766,17.1051,17.2299,17.351,17.468,17.5809,17.6901,17.7961,17.899,17.9992,18.0969,18.1923,18.2853,18.3759,18.4639,18.5495,18.6325,18.7127,18.7902,18.8646,18.9359,19.0039,19.0686,19.1299,19.1883,19.2435,19.2955,19.3441,19.3893,19.431,19.4692,19.5036,19.5345,19.5621,19.5863,19.6072,19.6247,19.639,19.65,19.6575,19.6609,19.6602,19.6555,19.6464,19.6332,19.6159,19.5949,19.5705,19.5425,19.5111,19.4765,19.4395,19.4003,19.3589,19.3152,19.2687,19.2195,19.1674,19.1128,19.0561,18.9978,18.9381,18.8768,18.8144,18.7507,18.6863,18.6213,18.5558,18.4896,18.4222,18.3537,18.2842,18.2135,18.1413,18.0674,17.992,17.9149,17.8356,17.7542,17.6708,17.5856,17.4986,17.4095,17.3181,17.2246,17.1292,17.0319,16.9332,16.8334,16.7327,16.631,16.5282,16.4241,16.319,16.2131,16.1064,15.9987,15.89,15.7804,15.67,15.5591,15.4477,15.336,15.2241,15.1123,15.0007,14.8897,14.7792,14.6696,14.5608,14.4527,14.3451,14.2382,14.132,14.0269,13.9227,13.8194,13.7169,13.6152,13.5142,13.4142,13.315,13.2168,13.1198,13.0239,12.929,12.8349,12.7417,12.6495,12.5583,12.468,12.3787,12.2905,12.2033,12.1168,12.0309,11.9456,11.8608,11.7762,11.6918,11.6075,11.5232,11.4391,11.3551,11.2712,11.1877,11.1044,11.0214,10.9388,10.8566,10.7748,10.6935,10.6128,10.5323,10.4519,10.3717,10.2918,10.2122,10.1328,10.0536,9.9748,9.896,9.8172,9.738,9.6586,9.5791,9.4997,9.4202,9.3407,9.2614,9.1825,9.1039,9.0256,8.9478,8.8704,8.7935,8.7168,8.6404,8.5644,8.4888,8.4134],"name":"Daily Climatology","mode":"lines","type":"scatter","line":{"color":"rgb(102, 102, 102)","width":3,"dash":"dash"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021-01-01","2021-01-02","2021-01-03","2021-01-04","2021-01-05","2021-01-06","2021-01-07","2021-01-08","2021-01-09","2021-01-10","2021-01-11","2021-01-12","2021-01-13","2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23","2021-02-24","2021-02-25","2021-02-26","2021-02-27","2021-02-28","2021-03-01","2021-03-02","2021-03-03","2021-03-04","2021-03-05","2021-03-06","2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20","2021-03-21","2021-03-22","2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15","2021-04-16","2021-04-17","2021-04-18","2021-04-19","2021-04-20","2021-04-21","2021-04-22","2021-04-23","2021-04-24","2021-04-25","2021-04-26","2021-04-27","2021-04-28","2021-04-29","2021-04-30","2021-05-01","2021-05-02","2021-05-03","2021-05-04","2021-05-05","2021-05-06","2021-05-07","2021-05-08","2021-05-09","2021-05-10","2021-05-11","2021-05-12","2021-05-13","2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30","2021-05-31","2021-06-01","2021-06-02","2021-06-03","2021-06-04","2021-06-05","2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05","2021-07-06","2021-07-07","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-13","2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30","2021-07-31","2021-08-01","2021-08-02","2021-08-03","2021-08-04","2021-08-05","2021-08-06","2021-08-07","2021-08-08","2021-08-09","2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03","2021-09-04","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14","2021-10-15","2021-10-16","2021-10-17","2021-10-18","2021-10-19","2021-10-20","2021-10-21","2021-10-22","2021-10-23","2021-10-24","2021-10-25","2021-10-26","2021-10-27","2021-10-28","2021-10-29","2021-10-30","2021-10-31","2021-11-01","2021-11-02","2021-11-03","2021-11-04","2021-11-05","2021-11-06","2021-11-07","2021-11-08","2021-11-09","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-14","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-19","2021-11-20","2021-11-21","2021-11-22","2021-11-23","2021-11-24","2021-11-25","2021-11-26","2021-11-27","2021-11-28","2021-11-29","2021-11-30","2021-12-01","2021-12-02","2021-12-03","2021-12-04","2021-12-05","2021-12-06","2021-12-07","2021-12-08","2021-12-09","2021-12-10","2021-12-11","2021-12-12","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-17","2021-12-18","2021-12-19","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31"],"y":[7.3983,7.326,7.2525,7.1802,7.1086,7.0372,6.9651,6.8917,6.8182,6.744,6.6698,6.5978,6.5248,6.4555,6.3884,6.3234,6.2579,6.196,6.1362,6.0775,6.0197,5.9619,5.9058,5.8493,5.7939,5.7401,5.6879,5.6377,5.5902,5.5444,5.499,5.4544,5.4104,5.3686,5.3282,5.2894,5.2519,5.2162,5.1833,5.1518,5.1218,5.0925,5.0629,5.0339,5.0047,4.9761,4.9488,4.9226,4.8964,4.8706,4.8459,4.8246,4.8052,4.7858,4.7677,4.7497,4.7318,4.7149,4.6993,4.6711,4.6579,4.6442,4.6317,4.62,4.6095,4.5994,4.5903,4.582,4.5747,4.5686,4.5637,4.5616,4.5632,4.5669,4.5722,4.579,4.5866,4.5947,4.6047,4.6167,4.6314,4.6473,4.6664,4.6883,4.7137,4.7413,4.7697,4.8001,4.8323,4.8679,4.9046,4.9442,4.987,5.0324,5.0801,5.1297,5.1846,5.244,5.3071,5.3738,5.444,5.5156,5.5866,5.6581,5.733,5.8093,5.8878,5.9691,6.0526,6.1392,6.2291,6.3191,6.4117,6.5048,6.6015,6.6971,6.7933,6.8925,6.9926,7.0957,7.1978,7.3012,7.404,7.5086,7.6122,7.7145,7.8168,7.9184,8.0199,8.1221,8.2246,8.3292,8.4386,8.5505,8.6616,8.7719,8.8824,8.9918,9.1016,9.2151,9.3288,9.4417,9.5565,9.6704,9.7902,9.91,10.0352,10.1627,10.2923,10.4276,10.5613,10.6949,10.8288,10.9679,11.1135,11.2622,11.4164,11.5728,11.7279,11.8821,12.0351,12.1881,12.3397,12.4902,12.6412,12.7952,12.9519,13.1102,13.2694,13.4283,13.5867,13.7466,13.9069,14.0672,14.2293,14.3869,14.5442,14.6983,14.8516,15.0014,15.147,15.2938,15.443,15.5907,15.7321,15.8644,15.991,16.1115,16.2275,16.3444,16.4588,16.5747,16.686,16.7926,16.8955,16.9948,17.09,17.1804,17.2691,17.3581,17.4468,17.5333,17.6166,17.6959,17.7714,17.8427,17.9088,17.9707,18.0305,18.0872,18.1419,18.1929,18.2378,18.2738,18.3076,18.3394,18.369,18.399,18.4278,18.4557,18.4782,18.4979,18.5109,18.5225,18.5309,18.5332,18.5326,18.5288,18.5177,18.4975,18.4731,18.4439,18.4111,18.3755,18.3386,18.3002,18.2611,18.222,18.1821,18.1391,18.0923,18.0422,17.9901,17.934,17.8782,17.8202,17.7624,17.7032,17.6431,17.5828,17.5201,17.4563,17.3913,17.3249,17.2568,17.1871,17.1171,17.0411,16.9645,16.8907,16.8193,16.7435,16.661,16.5748,16.4858,16.3942,16.3012,16.2049,16.104,16.0001,15.8927,15.7842,15.6742,15.5622,15.4539,15.3478,15.2429,15.1366,15.0292,14.9154,14.8014,14.6871,14.5728,14.4592,14.3451,14.2324,14.1218,14.0112,13.9045,13.7968,13.6872,13.5778,13.4712,13.3696,13.2696,13.1684,13.0668,12.9633,12.861,12.7622,12.6644,12.5692,12.4743,12.3811,12.2881,12.195,12.1007,12.0053,11.9108,11.8185,11.7324,11.6452,11.5589,11.4713,11.3839,11.2973,11.212,11.1261,11.0432,10.9612,10.881,10.8001,10.7186,10.6347,10.5518,10.4683,10.3843,10.3013,10.2206,10.1407,10.06,9.9796,9.8995,9.8217,9.7438,9.6673,9.5912,9.5155,9.4397,9.3625,9.2847,9.2068,9.129,9.052,8.9766,8.9001,8.8254,8.7472,8.6685,8.5878,8.5093,8.4291,8.3514,8.2765,8.2022,8.1281,8.0536,7.9823,7.9115,7.8406,7.7683,7.695,7.6202,7.5452,7.471],"name":"MCS Threshold","mode":"lines","type":"scatter","line":{"color":"rgb(135, 206, 235)","width":1,"dash":"dot"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23",null,"2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16",null,"2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15",null,"2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30",null,"2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05",null,"2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30",null,"2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03",null,"2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14","2021-10-15","2021-10-16","2021-10-17","2021-10-18","2021-10-19","2021-10-20","2021-10-21","2021-10-22","2021-10-23","2021-10-24","2021-10-25","2021-10-26","2021-10-27","2021-10-28","2021-10-29","2021-10-30","2021-10-31","2021-11-01","2021-11-02","2021-11-03","2021-11-04","2021-11-05","2021-11-06","2021-11-07","2021-11-08","2021-11-09","2021-11-10","2021-11-11","2021-11-12","2021-11-13","2021-11-14","2021-11-15","2021-11-16","2021-11-17","2021-11-18","2021-11-19","2021-11-20","2021-11-21","2021-11-22","2021-11-23","2021-11-24","2021-11-25","2021-11-26","2021-11-27","2021-11-28",null,"2021-12-10","2021-12-11","2021-12-12","2021-12-13","2021-12-14","2021-12-15","2021-12-16","2021-12-17","2021-12-18","2021-12-19","2021-12-20","2021-12-21","2021-12-22","2021-12-23","2021-12-24","2021-12-25","2021-12-26","2021-12-27","2021-12-28","2021-12-29","2021-12-30","2021-12-31"],"y":[8.63949203491211,8.71224308013916,8.71546268463135,8.62837886810303,8.67225933074951,8.78775787353516,8.70401287078857,8.48922824859619,8.41090106964111,8.38719367980957,8.30350494384766,8.28661727905273,8.11338520050049,7.97213697433472,7.88549947738647,7.80356216430664,7.72993421554565,7.64998722076416,7.7422399520874,7.76347541809082,7.68549871444702,7.62804460525513,7.37471008300781,7.31167697906494,7.22169876098633,6.96164846420288,6.86123847961426,6.8663501739502,6.87070465087891,6.82513380050659,6.72320556640625,6.64764833450317,6.65541934967041,6.92770433425903,6.98187255859375,6.94456577301025,6.92743444442749,6.79479789733887,6.53643178939819,6.44363975524902,6.28765201568604,null,6.36843538284302,6.72554445266724,6.66021108627319,6.64970922470093,6.49181127548218,6.17545557022095,null,6.63554048538208,6.87098836898804,7.15458965301514,7.0654411315918,6.93267345428467,6.80781698226929,6.84691381454468,7.03539752960205,7.21804666519165,7.26168155670166,6.98310804367065,6.92679071426392,6.9091944694519,6.96913719177246,7.11034631729126,7.37439203262329,7.67831563949585,7.89472341537476,8.083984375,8.17249774932861,7.99165868759155,7.61568212509155,7.63175439834595,7.55266809463501,null,10.6801910400391,11.1952352523804,11.6427459716797,12.2267093658447,12.6055564880371,12.5560464859009,12.6658115386963,12.7438554763794,12.997031211853,12.9999408721924,12.5859880447388,12.4967994689941,12.7307796478271,13.1244029998779,13.2610235214233,13.0793342590332,12.8586416244507,null,14.6243419647217,15.3000898361206,15.4125080108643,15.6645622253418,16.0080165863037,15.9171209335327,15.3487424850464,15.3591709136963,15.7051038742065,16.0243091583252,16.5155181884766,16.6427192687988,16.7237758636475,16.9374465942383,17.1644134521484,17.7055606842041,17.9937572479248,17.511100769043,17.3202438354492,17.5893611907959,17.8269138336182,17.9963855743408,18.7609252929688,19.3711967468262,19.5692749023438,19.6127243041992,19.3981647491455,18.9093685150146,18.5936660766602,18.1641082763672,null,20.1304988861084,20.5480899810791,20.2804412841797,20.2796669006348,20.4419651031494,20.3985004425049,20.3409957885742,20.4126720428467,20.3738861083984,20.3899936676025,20.5528926849365,20.4931488037109,20.432580947876,20.6694278717041,20.775484085083,20.7435684204102,20.2348651885986,null,20.9464054107666,21.3332099914551,22.0618457794189,22.2094249725342,22.2472877502441,22.2901058197021,21.9405460357666,21.8638210296631,21.8379535675049,21.5776748657227,21.6463203430176,21.8719177246094,22.0385513305664,21.8664131164551,21.6876049041748,21.7484321594238,22.0744609832764,22.3965473175049,22.3451614379883,21.7711639404297,21.5734310150146,21.7161769866943,21.8078956604004,21.0150909423828,20.0285797119141,null,19.8889446258545,20.0749397277832,20.2172241210938,20.2950592041016,20.1225070953369,19.9214973449707,19.8866539001465,19.8311004638672,19.898006439209,20.0595512390137,20.1366786956787,20.2095699310303,20.336540222168,20.2903099060059,20.1229133605957,19.9763107299805,19.9281558990479,20.0528221130371,20.1933269500732,20.1863670349121,20.0910243988037,19.8714389801025,19.800422668457,19.639087677002,19.2109375,18.9142417907715,18.7804279327393,18.7456970214844,18.7615585327148,18.7741622924805,18.7405834197998,18.7722797393799,18.7211036682129,18.6289920806885,18.4753017425537,18.4267139434814,18.4153251647949,18.3357849121094,18.455322265625,18.4758129119873,18.4339332580566,18.202075958252,17.8932437896729,17.417064666748,17.0632972717285,17.0004329681396,17.0379428863525,16.9497108459473,16.7845630645752,16.7014694213867,16.6359996795654,16.3930435180664,16.2924423217773,16.085205078125,15.8699102401733,15.6584796905518,15.5297718048096,15.3793573379517,15.2355337142944,15.114725112915,14.875789642334,14.7283191680908,14.6113471984863,14.5513334274292,14.5182399749756,14.3858041763306,14.2505683898926,14.2074241638184,14.131329536438,14.0319042205811,13.9059524536133,13.7011919021606,13.5346336364746,13.4862546920776,13.4513969421387,13.2983798980713,13.1414699554443,13.056357383728,12.892463684082,12.7776107788086,12.6546154022217,12.4923858642578,12.2107391357422,11.9953355789185,null,11.3677196502686,11.2311334609985,11.1660041809082,11.182186126709,11.1458253860474,11.0548715591431,11.0576333999634,11.0651416778564,11.0418930053711,11.0270776748657,10.8833904266357,10.770956993103,10.6502914428711,10.494402885437,10.4503078460693,10.396915435791,10.3672695159912,10.3484525680542,10.3328866958618,10.3458395004272,10.3166437149048,10.2671327590942],"name":"Marine Heatwave Event","mode":"lines","type":"scatter","line":{"color":"rgb(139, 0, 0)","width":2},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","line":{"color":"rgb(65, 105, 225)","width":2},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="temperatures" class="level3">
<h3 class="anchored" data-anchor-id="temperatures">2022 Temperatures</h3>
<p>Temperatures for the current year can be seen against the same thresholds with the following plot:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/mhw%20ggplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="anomalies" class="level3">
<h3 class="anchored" data-anchor-id="anomalies">2022 Anomalies</h3>
<p>Changing from absolute temperatures to anomalies reveals the degree to which this year is departure from what we would have expected from the climatology of 1982-2011’s temperatures.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/heatwave%20anomaly%20timeline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="in-context" class="level3">
<h3 class="anchored" data-anchor-id="in-context">2022 in Context</h3>
<p>When 2022 is overlaid against the daily values and climatological average for the region, we can see how temperatures compare to the history of the region.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="global-temperature-maps" class="level1">
<h1>3: Global Temperature Maps</h1>
<p>The 2021 global sea surface temperature anomalies have been loaded and displayed below to visualize how different areas of the ocean experience swings in temperature.</p>
<p>For perspective on where excess heat is distributed around the world, here first are maps of anomalies at a global perspective:</p>
<div class="cell">

</div>
<div class="panelset">
<section id="annual-average" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="annual-average">Annual Average</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="winter" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="winter">Winter</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="spring" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="spring">Spring</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summer" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="summer">Summer</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fall" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="fall">Fall</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</div>
</section>
<section id="regional-temperature-maps" class="level1">
<h1>4: Regional Temperature Maps</h1>
<p>The regional views of 2021’s sea surface temperature anomalies have been loaded and displayed below to visualize how localized differences changed throughout the year.</p>
<div class="cell">

</div>
<div class="panelset">
<section id="annual-average-1" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="annual-average-1">Annual Average</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="winter-1" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="winter-1">Winter</h2>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="spring-1" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="spring-1">Spring</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="summer-1" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="summer-1">Summer</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fall-1" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="fall-1">Fall</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="heatwave-progression" class="level2 panel-name panel">
<h2 class="panel-name anchored" data-anchor-id="heatwave-progression">Heatwave Progression</h2>
<p>Looking specifically at the last heatwave event, we can step through how the event progressed over time, and developing pockets or warmer/colder water masses.</p>
<div class="cell">

</div>
<div class="cell" data-animation.hook="gifski">

</div>
</section>
</div>
</section>
<section id="ranking-warming-rates" class="level1">
<h1>5: Ranking Warming Rates</h1>
<p>If we look at the rates of change from 1982-2021 for each grid cell, rather than the observed temperature, it is possible to rank how hot each location on earth is warming relative to all the others.</p>
<p>Once we have the rankings, we can then take the average ranking within the Gulf of Maine we can obtain the average warming rank for the area compared to the rest of the globe.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p>Based on data from 1982-2021, the warming rates of Northeastern US Shelf Region have been some of the highest in the world. The area as a whole has been increasing at a rate of 0.038<span class="math inline">\(^{\circ}C/year\)</span> which is faster than 91.6% of the world’s oceans.</p>
<p>Over that same period locations within the Northeastern US Shelf Region have been warming at rates as low as -0.017<span class="math inline">\(^{\circ}C/year\)</span> and as rapidly as 0.07<span class="math inline">\(^{\circ}C/year\)</span>, corresponding to ranks as low as 0.2% and as high as 99.9%.</p>
<p>Mapped below are the corresponding warming rates and their global rankings.</p>
<div class="cell">

</div>
<section id="warming-rates-1" class="level3">
<h3 class="anchored" data-anchor-id="warming-rates-1">Warming Rates</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="warming-ranks" class="level3">
<h3 class="anchored" data-anchor-id="warming-ranks">Warming Ranks</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="shifting-baselines" class="level1">
<h1>6: Shifting Baselines</h1>
<p>In 2021 NOAA is transitioning standard climatologies from the 30-year period of 1982-2011 to a new period spanning 1992-2020. Changes in climate regimes often does not result in a uniform upward or downward change that is consistent throughout the year.</p>
<p>The plot below shows just how both the average temperature, as well as the annual highs and lows have shifted. When looking specifically at Northeastern US Shelf Region here is how the expected temperature for each day of the year has shifted.</p>
<p>From this we can see that the Fall temperatures have risen more than those of the spring. There is also a large change in where the threshold for Marine Heatwave events sits, a consequence of exceptionally warm Fall temperatures becoming more common.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Northeast_shelf_update_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>

<!---- Rmarkdown Custom Footer for Author Details - Modify personal info as needed ------>

<!---- Custom Footer ------->
&nbsp;

<!---- Add GMRI Logo to footer ---->

<!--
<p style="text-align: center;">
    <img src="presentations/gmri_logo.png" alt="GMRI Logo" height="91" width="248">
</p>
-->

<!---- Author Details  ------>
<hr>
<p style="text-align: center; font-size: 60%; padding: 0px;">A work by <a href="https://github.com/adamkemberling/">Adam A. Kemberling</a></p>
<p style="text-align: center; font-size: 60%; padding: 0px;"><span style="color: #808080;"><em>Akemberling@gmri.org</em></span></p>





<!-- Add Font-Awesome Icon Library -->
<!--

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

-->

<!-- Add Icons with Personal Links -->
<!--

<p style="text-align: center;">
    <a href="https://twitter.com/r_graph_gallery?lang=en" class="fa fa-twitter"></a>
    <a href="https://www.linkedin.com/in/yan-holtz-2477534a/" class="fa fa-linkedin"></a>
    <a href="https://github.com/holtzy/" class="fa fa-github"></a>
</p>

-->

&nbsp;

<!--- End Custom Footer --->




</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Northeastern US Continental Shelf SST Report"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">    name: "Adam Kemberling"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://github.com/adamkemberling</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Gulf of Maine Research Institute</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> | </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Temperature tracking for the Northeastern US Continental Shelf Region</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "Updated on: `r Sys.Date()`"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.height: 6</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.width: 8</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.align: "center"</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: ""</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># date support</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)  <span class="co"># raster support</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth) <span class="co"># coastline polygons</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># simple feature support</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stars) <span class="co"># raster plotting with ggplot</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmRi) <span class="co"># styling for GMRI</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co"># axis labels</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># project navigation</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># library(janitor) # data cleaning</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># multiplot arrangement</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># data wrangling and plotting</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(heatwaveR) <span class="co"># heatwave detection</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># interactive plots</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc) <span class="co"># statistics added to plots</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># table styling</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalt) <span class="co"># Geom dumbbell and lollipop</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geomtextpath) <span class="co"># text within geom_lines or geom_smooth </span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xaringanExtra) <span class="co"># tab panels</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce) <span class="co"># smart text labels in plots &amp; facet_zoom</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes) <span class="co"># theme support</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel) <span class="co"># text labeling</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext) <span class="co"># Colored ggplot text</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xaringanExtra) <span class="co"># For tabsets</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Support Functions</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R/oisst_support_funs.R"</span>)))</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"R/temp_report_support.R"</span>)))</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>path_fun <span class="ot">&lt;-</span> <span class="fu">os_fun_switch</span>(<span class="at">mac_os =</span> <span class="st">"mojave"</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># File Paths</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>mills_path <span class="ot">&lt;-</span> <span class="fu">path_fun</span>(<span class="st">"mills"</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>oisst_path <span class="ot">&lt;-</span> <span class="fu">path_fun</span>(<span class="st">"res"</span>, <span class="st">"OISST/oisst_mainstays"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Set ggplot theme for figures</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Titles</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.2</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>), <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.5</span>),</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Axes</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(), </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(), </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Facets</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                              <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"#00736D"</span>, </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype=</span><span class="st">"solid"</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Polygons for mapping</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>new_england <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="st">"united states of america"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>canada      <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="st">"canada"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>world       <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>greenland   <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="at">country =</span> <span class="st">"greenland"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding Logo to plot</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>logo_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">"stylesheets"</span>, <span class="at">package =</span> <span class="st">"gmRi"</span>), <span class="st">"/gmri_logo.png"</span>)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>lab_logo <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(logo_path)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r params formatting}</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the shapefile to use as a parameter</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">region  =</span> <span class="st">"inuse_strata"</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="co"># File paths for various extents based on params$region</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>region_paths <span class="ot">&lt;-</span> <span class="fu">get_timeseries_paths</span>(<span class="at">region_group =</span> <span class="st">"nmfs_trawl_regions"</span>, </span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">mac_os =</span> <span class="st">"mojave"</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the name</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>tidy_name <span class="ot">&lt;-</span> <span class="st">"Northeastern US Shelf Region"</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Current Year</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>current_yr <span class="ot">&lt;-</span> <span class="fu">year</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Use panelset</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="fu">use_panelset</span>()</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn on the stylesheet:</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>gmRi<span class="sc">::</span><span class="fu">use_gmri_style_rmd</span>(<span class="at">css =</span> <span class="st">"gmri_rmarkdown.css"</span>)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn on the gmri font for plots</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>showtext<span class="sc">::</span><span class="fu">showtext_auto</span>()</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="fu">#  `r paste(tidy_name, current_yr)`: Sea Surface Temperature</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>This report was created to track the sea surface temperature regimes for the Northeastern US continental shelf, an area sampled as part of the NMFS Northeast trawl survey.</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>Satellite sea surface temperature data used was obtained from the National Center for Environmental Information (NCEI). With all maps and figures displaying <span class="co">[</span><span class="ot">NOAA's Optimum Interpolation Sea Surface Temperature Data</span><span class="co">](https://www.ncdc.noaa.gov/oisst)</span>.</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>**DISCLAIMER:** Any data within 2-weeks of the current date are subject to revision and may change. Please use caution when reporting information that contains these values.</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="fu">### `r tidy_name` On a Map</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>Whenever discussing the <span class="in">`r tidy_name`</span> in this report, we refer to the following spatial extent displayed below. The coordinates of this bounding box are the same coordinates used to clip the sea surface temperature data.</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the bounding box for Andy's GOM to show they align</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>poly_path     <span class="ot">&lt;-</span> region_paths[[params<span class="sc">$</span>region]][[<span class="st">"shape_path"</span>]]</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>region_extent <span class="ot">&lt;-</span> <span class="fu">st_read</span>(poly_path, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="co"># region_extent &lt;- st_union(region_extent)</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull extents for the region to set crop extent</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>crop_x <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(region_extent)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>crop_y <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(region_extent)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the study area</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="fu">map_study_area</span>(<span class="at">region_extent =</span> <span class="fu">st_union</span>(region_extent),</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>               <span class="at">x_buffer =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>               <span class="at">y_buffer =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.75</span>), </span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>               <span class="at">new_england_sf =</span> new_england, </span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>               <span class="at">canada_sf =</span> canada,</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>               <span class="at">greenland_sf =</span> greenland,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape_linetype =</span> <span class="dv">2</span>)</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1: Temperature History</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>Using the coordinates shown above we can create an area-specific temperature history. For any day of the year since **September of 1981**, data is available to calculate the average sea surface temperature within that area for each day. </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>Additionally, we can compare observed temperatures against the expected conditions based on a climatology using a specified  reference period. The standard reference period used for the climatology here is 1982-2011, a 30-year period.</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load data}</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the timeseries</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>timeseries_path <span class="ot">&lt;-</span> region_paths[[params<span class="sc">$</span>region]][[<span class="st">"timeseries_path"</span>]]</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>region_timeseries <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(timeseries_path, </span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>                              <span class="at">col_types =</span> <span class="fu">cols</span>(), </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>                              <span class="at">guess_max =</span> <span class="fl">1e6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tod =</span> <span class="fu">format</span>(time, <span class="at">format =</span> <span class="st">"%H:%M:%S"</span>)) </span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up the data - add labels</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>region_timeseries <span class="ot">&lt;-</span> region_timeseries <span class="sc">%&gt;%</span> </span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.Date</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(time, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">supplement_season_info</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2022</span>))</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize by year to return mean annual anomalies and variance</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>annual_summary <span class="ot">&lt;-</span> region_timeseries <span class="sc">%&gt;%</span> </span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">temperature_summaries</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yr_as_dtime =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="st">"-07-02"</span>)),</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>         <span class="at">anom_direction =</span> <span class="fu">ifelse</span>(area_wtd_anom <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Hot"</span>, <span class="st">"Cold"</span>))</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Get heatwave statuses for each day:</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Uses area weighted sst by default</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>region_hw <span class="ot">&lt;-</span> <span class="fu">pull_heatwave_events</span>(</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature_timeseries =</span> region_timeseries, </span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="dv">90</span>, </span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">clim_ref_period =</span> <span class="fu">c</span>(<span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">supplement_hw_data</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(doy <span class="sc">!=</span> <span class="dv">366</span>)</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a> <span class="co"># Last Calendar Year</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>this_yr <span class="ot">&lt;-</span> region_hw <span class="sc">%&gt;%</span> </span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(time) <span class="sc">==</span> <span class="dv">2022</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the date within a year for Heatmap</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>base_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>)</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>grid_data <span class="ot">&lt;-</span> region_hw <span class="sc">%&gt;%</span> </span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time),</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">yday =</span> <span class="fu">yday</span>(time),</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">flat_date =</span> <span class="fu">as.Date</span>(yday<span class="dv">-1</span>, <span class="at">origin =</span> base_date),</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>         <span class="at">yr_rev =</span> <span class="fu">factor</span>(year),</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>         <span class="at">yr_rev =</span> <span class="fu">fct_rev</span>(yr_rev))</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a><span class="co"># # Global Temperature Anomaly Rates</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>global_anoms <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(oisst_path, <span class="st">"global_timeseries/global_anoms_1982to2011.csv"</span>), </span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">guess_max =</span> <span class="fl">1e6</span>,</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">1982</span>, <span class="dv">2021</span>))</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize by year again</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>global_summary <span class="ot">&lt;-</span> global_anoms <span class="sc">%&gt;%</span> </span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">temperature_summaries</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yr_as_dtime =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year, <span class="st">"-07-02"</span>)),</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>         <span class="at">anom_direction =</span> <span class="fu">ifelse</span>(area_wtd_anom <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Hot"</span>, <span class="st">"Cold"</span>))</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Climatological Patterns of the `r tidy_name`</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>Daily climatologies are a record of daily averages based on the day of the year. They record what the average temperature has been for each day of the year, across the specified reference period. </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>In addition to the daily average, we also look at how variable temperatures are. This variability is used to benchmark how "rare" extreme events are to determine whether they are part of a natural cycle or not.</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>Common benchmarks for extreme events are the 10th and 90th percentile. Temperatures above the 90th percentile are among the hottest 10% of days in the reference period. Temperatures below the 10th percentile correspond to the coldest 10%. The remaining 80% of days fall somewhere in-between and showcase the range of temperatures we might expect to occur given the natural variability of the climate.</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>clim_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Daily Temperature"</span>      <span class="ot">=</span> <span class="st">"gray80"</span>,</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Climatological Average"</span> <span class="ot">=</span> <span class="st">"gray10"</span>,</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>  <span class="st">"90th Percentile"</span>        <span class="ot">=</span> <span class="st">"coral3"</span>,</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10th Percentile"</span>        <span class="ot">=</span> <span class="st">"royalblue"</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a><span class="co"># pull one year for the lines, the reference period for points</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>one_yr <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(yr <span class="sc">==</span> <span class="dv">2021</span>)</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>ref_yrs <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(yr <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2011</span>))</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> one_yr, <span class="fu">aes</span>(<span class="at">x =</span> flat_date)) <span class="sc">+</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> ref_yrs, <span class="fu">aes</span>(<span class="at">y =</span> sst, <span class="at">color =</span> <span class="st">"Daily Temperature"</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> seas, <span class="at">color =</span> <span class="st">"Climatological Average"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">y =</span> mhw_thresh, <span class="at">color =</span> <span class="st">"90th Percentile"</span>, <span class="at">label =</span> <span class="st">"Heatwave Threshold"</span>), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="fl">0.4</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_textline</span>(<span class="fu">aes</span>(<span class="at">y =</span> mcs_thresh, <span class="at">color =</span> <span class="st">"10th Percentile"</span>, <span class="at">label =</span> <span class="st">"Coldspell Threshold"</span>), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>)) <span class="sc">+</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> clim_colors) <span class="sc">+</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day of the Year"</span>, <span class="at">y =</span> <span class="st">"Sea Surface Temperature"</span>,</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">str_c</span>(tidy_name, <span class="st">" Daily Climatology"</span>),</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Anticipated Daily Temperatures Based on a 1982-2011 Climate"</span>) <span class="sc">+</span></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_gmri() +</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,.<span class="dv">3</span>,.<span class="dv">5</span>), <span class="st">"cm"</span>),</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.position =</span> <span class="st">"left"</span>,</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.position =</span> <span class="st">"top"</span>, </span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"gray50"</span>, <span class="st">"gray10"</span>, <span class="st">"coral3"</span>, <span class="st">"royalblue"</span>),</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),  </span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>)),</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>        <span class="at">byrow =</span> T))</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working in Anomalies</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>Using the climatology as a reference, we can see hot much "hotter" or "colder" a given day is than what we would on average expect. This difference from the average is what we call anomalies. </span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>In the table below, <span class="in">`Sea Surface Temperature`</span> is the mean temperature observed for that date averaged across all cells within the area. <span class="in">`Climate Avg.`</span> &amp; <span class="in">`Climate SD`</span> are the climate means and standard deviations for a 1982-2011 climatology. <span class="in">`Temperature Anomaly`</span> is the daily observed sea surface temperature minus the climate mean.</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>In this way a <span class="in">`Temperature Anomaly`</span> is just: How much hotter or colder is it than the average temperature for that day.</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Table of last 6 entries</span></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(region_timeseries) <span class="sc">%&gt;%</span> </span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> time,</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sea Surface Temperature</span><span class="st">`</span> <span class="ot">=</span> sst,</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>    <span class="co">#`Area-Weighted SST` = area_wtd_sst,</span></span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Day of Year</span><span class="st">`</span> <span class="ot">=</span> modified_ordinal_day,</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Climate Avg.</span><span class="st">`</span> <span class="ot">=</span> sst_clim,</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>    <span class="co">#`Area-weighted Climate` = area_wtd_clim,</span></span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Temperature Anomaly</span><span class="st">`</span> <span class="ot">=</span> sst_anom<span class="co">#,</span></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>    <span class="co">#`Area-Weighted Anomaly` = area_wtd_anom</span></span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**"</span>, tidy_name, <span class="st">" - Regional Sea Surface Temperature"</span>, <span class="st">"**"</span>)), </span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Temperature Unit: Celsius"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"*Data Source: NOAA OISSTv2 Daily Sea Surface Temperature Data.*"</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="fu">md</span>(<span class="st">"*Climatology Reference Period: 1982-2011.*"</span>))</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a><span class="co"># march 1st sst</span></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>mar1 <span class="ot">&lt;-</span> region_timeseries <span class="sc">%&gt;%</span> </span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(modified_ordinal_day <span class="sc">==</span> <span class="dv">61</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(sst_clim) <span class="sc">%&gt;%</span> </span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sst_clim)</span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Detecting Long-Term Changes</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>One reason we go through this trouble of calculating climatologies and anomalies is to set expectations around how much we expect things to naturally vary, and to detect when things fall outside that range.</span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>In the case of the <span class="in">`r tidy_name`</span> we are now consistently outside of the range of temperatures normally expected from 1982-2011. The following plot colors the monthly average by how far temperatures are from the climatological average. Blue colors represent a month that was cooler than average, with red indicating a warmer than average month.</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, temp stripes, fig.height=2.25}</span></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Monthly Averages</span></span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>monthly_temps <span class="ot">&lt;-</span> region_timeseries <span class="sc">%&gt;%</span> </span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> <span class="fu">year</span>(time),</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>           <span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sst =</span> <span class="fu">mean</span>(area_wtd_sst),</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>            <span class="at">anom =</span> <span class="fu">mean</span>(area_wtd_anom),</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.Date</span>(<span class="fu">str_c</span>(year, <span class="fu">str_pad</span>(month, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>, <span class="at">side =</span> <span class="st">"left"</span>), <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>)))</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot monthly timeline</span></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_temps, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> anom)) <span class="sc">+</span></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span>), <span class="at">oob =</span> oob_squish) <span class="sc">+</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.01</span>))) <span class="sc">+</span></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">45</span>))) <span class="sc">+</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.125</span>),</span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">7.2</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">20</span>), <span class="at">color =</span> <span class="st">"gray40"</span>)</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">str_c</span>(tidy_name, <span class="st">"</span><span class="sc">\n</span><span class="st">Monthly Sea Surface Temperature Anomalies"</span>),</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Monthly Averages from 1982-2021  |  Climatology Period 1982-2011"</span>)</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### Warming Rates {.tabset}</span></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>Seeing this change towards a warmer climate, it is then natural to ask how rapidly the change is happening. This is where we turn to warming rates. The warming trends below were calculated using all the available data for complete years beginning with 1982 through the end of 2021. </span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>The overlaid trend lines then track how warming has increased with time. A dotted line has been included to show how the global average temperature has changed during the same period.</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Warming Trends</span></span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual regressions}</span></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a><span class="do">####  Run Warming Rate regressions  ####</span></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>rate_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GoM All F"</span> <span class="ot">=</span> <span class="fu">get_decadal_rates</span>(</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_df =</span> annual_summary, </span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_col =</span> <span class="st">"area_wtd_f"</span>, </span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_col =</span> <span class="st">"year"</span>, </span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_lim =</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>), </span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_name =</span> <span class="st">"GoM"</span>, </span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_c =</span> F),</span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GoM All C"</span> <span class="ot">=</span> <span class="fu">get_decadal_rates</span>(</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_df =</span> annual_summary, </span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_col =</span> <span class="st">"area_wtd_sst"</span>, </span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_col =</span> <span class="st">"year"</span>, </span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_lim =</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>), </span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_name =</span> <span class="st">"GoM"</span>, </span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_c =</span> T),</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GoM 15"</span> <span class="ot">=</span> <span class="fu">get_decadal_rates</span>(</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_df =</span> annual_summary, </span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_col =</span> <span class="st">"area_wtd_f"</span>, </span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_col =</span> <span class="st">"year"</span>, </span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_lim =</span> <span class="fu">c</span>(<span class="dv">2007</span>, <span class="dv">2021</span>), </span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_name =</span> <span class="st">"GoM"</span>, </span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_c =</span> F),</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Global All"</span> <span class="ot">=</span> <span class="fu">get_decadal_rates</span>(</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_df =</span> global_summary, </span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_col =</span> <span class="st">"area_wtd_f"</span>, </span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_col =</span> <span class="st">"year"</span>, </span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_lim =</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>), </span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_name =</span> <span class="st">"Global"</span>, </span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_c =</span> F),</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Global All C"</span> <span class="ot">=</span> <span class="fu">get_decadal_rates</span>(</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_df =</span> global_summary, </span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_col =</span> <span class="st">"area_wtd_sst"</span>, </span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_col =</span> <span class="st">"year"</span>, </span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_lim =</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>), </span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_name =</span> <span class="st">"Global"</span>, </span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree_c =</span> T))</span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Regression Equation Labels</span></span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>eq_all_c  <span class="ot">&lt;-</span> rate_data[[<span class="st">"GoM All C"</span>]][[<span class="st">"eq_label"</span>]]</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>eq_all    <span class="ot">&lt;-</span> rate_data[[<span class="st">"GoM All F"</span>]][[<span class="st">"eq_label"</span>]]</span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>eq_15     <span class="ot">&lt;-</span> rate_data[[<span class="st">"GoM 15"</span>]][[<span class="st">"eq_label"</span>]]</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>eq_global <span class="ot">&lt;-</span> rate_data[[<span class="st">"Global All"</span>]][[<span class="st">"eq_label"</span>]]</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>eq_global_c <span class="ot">&lt;-</span> rate_data[[<span class="st">"Global All C"</span>]][[<span class="st">"eq_label"</span>]]</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a smoothed temperature line using splines</span></span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>yearly_temp_smooth <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(<span class="fu">spline</span>(annual_summary<span class="sc">$</span>yr_as_dtime, annual_summary<span class="sc">$</span>area_wtd_anom)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(x, <span class="at">origin =</span> <span class="st">"1970-01-01"</span>))</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual trend plot}</span></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Fancy colored markdown titles and subtitles:</span></span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>gom_rate <span class="ot">&lt;-</span> <span class="fu">str_c</span>(rate_data<span class="sc">$</span><span class="st">`</span><span class="at">GoM All C</span><span class="st">`</span><span class="sc">$</span>decadal_rate <span class="sc">/</span> <span class="dv">10</span>, <span class="st">"\u00b0C / year"</span>)</span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a>glob_rate <span class="ot">&lt;-</span> <span class="fu">str_c</span>(rate_data<span class="sc">$</span><span class="st">`</span><span class="at">Global All C</span><span class="st">`</span><span class="sc">$</span>decadal_rate <span class="sc">/</span> <span class="dv">10</span>, <span class="st">"\u00b0C / year"</span>)</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>fancy_title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"&lt;span style='color:#00608A'&gt;"</span>,tidy_name, <span class="st">"&lt;/span&gt;"</span>, <span class="st">" Warming Faster than &lt;span style='color:#407331'&gt;Global Average&lt;/span&gt;"</span>)</span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>fancy_subtitle <span class="ot">&lt;-</span> <span class="fu">str_c</span>(tidy_name, <span class="st">"'s annual warming rate of &lt;span style='color:#00608A'&gt;"</span>,gom_rate, <span class="st">"&lt;/span&gt;, is 2.5X the global average of &lt;span style='color:#407331'&gt;"</span>, glob_rate,<span class="st">"&lt;/span&gt;."</span>)</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a><span class="do">####  Annual Trend Plot  ####</span></span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> annual_summary, <span class="fu">aes</span>(yr_as_dtime, area_wtd_anom)) <span class="sc">+</span></span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add daily data</span></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> region_timeseries,</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(time, area_wtd_anom, <span class="at">color =</span> <span class="st">"Daily Temperatures"</span>)) <span class="sc">+</span></span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overlay yearly means</span></span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> yearly_temp_smooth, <span class="fu">aes</span>(x, y, <span class="at">color =</span> <span class="st">"Average Yearly Temperature"</span>), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_line(color = "gray10", size = 1) +</span></span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"gray10"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression lines</span></span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textsmooth</span>(<span class="at">data =</span> <span class="fu">filter</span>(global_summary, year <span class="sc">&lt;=</span> <span class="dv">2021</span>),</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">text_smoothing =</span> <span class="dv">30</span>,</span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Global Trend"</span>,</span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"green"</span>),</span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> F,</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="fl">0.925</span>) <span class="sc">+</span></span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data =</span> <span class="fu">filter</span>(annual_summary, year <span class="sc">&lt;=</span> <span class="dv">2021</span>),</span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"1982-2021 Regional Trend"</span>), <span class="co">#label = "40-Year Trend",</span></span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> F,</span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Colors</span></span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1982-2021 Regional Trend"</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)),</span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Average Yearly Temperature"</span> <span class="ot">=</span> <span class="st">"gray10"</span>,</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daily Temperatures"</span>       <span class="ot">=</span> <span class="st">"gray90"</span>)) <span class="sc">+</span></span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axes</span></span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a>     <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="at">trans =</span> <span class="sc">~</span><span class="fu">as_fahrenheit</span>(., <span class="at">data_type =</span> <span class="st">"anomalies"</span>),</span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span>  <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0F"</span>)),</span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>)) <span class="sc">+</span></span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labels + theme</span></span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sea Surface Temperature Anomaly"</span>,</span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">"Anomalies calculated using 1982-2011 reference period."</span>),</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> fancy_title,</span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> fancy_subtitle) <span class="sc">+</span></span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme</span></span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(</span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot.title =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.position =</span> <span class="st">"left"</span>,</span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.position =</span> <span class="st">"top"</span>, </span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>          <span class="at">point =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>        <span class="at">byrow =</span> T)))</span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>**Region Shift in Ocean Circulation**</span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a>Beginning around 2008, temperature in the region swung upward, and since 2010 most yearly temperatures have been over 1 degree above the hematological average of the previous 30-years. With some years experiencing temperatures more than 2 degrees C above that average.</span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>clim_avg <span class="ot">&lt;-</span> annual_summary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span><span class="sc">:</span><span class="dv">2011</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">x =</span> <span class="dv">1982</span>,</span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a>            <span class="at">xend =</span> <span class="dv">2011</span>,</span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_c =</span> <span class="fu">mean</span>(area_wtd_sst, <span class="at">na.rm =</span> T),</span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_f =</span> <span class="fu">mean</span>(area_wtd_f, <span class="at">na.rm =</span> T),</span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_anom_c =</span> <span class="dv">0</span>,</span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_anom_f =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_numeric), round, <span class="dv">2</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_numeric), round, <span class="dv">2</span>))</span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a><span class="co"># average from 2010 onward:</span></span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a>r2_avg <span class="ot">&lt;-</span> annual_summary <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2010</span><span class="sc">:</span><span class="dv">2021</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">x =</span> <span class="dv">2010</span>,</span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>            <span class="at">xend =</span> <span class="dv">2021</span>,</span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_c =</span> <span class="fu">mean</span>(area_wtd_sst, <span class="at">na.rm =</span> T),</span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_f =</span> <span class="fu">mean</span>(area_wtd_f, <span class="at">na.rm =</span> T),</span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_anom_c =</span> <span class="fu">mean</span>(area_wtd_anom, <span class="at">na.rm =</span> T), </span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_anom_f =</span> <span class="fu">mean</span>(area_wtd_anom_f, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is_numeric), round, <span class="dv">2</span>))</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a><span class="do">####  Annual Trend Plot - regime shift  ####</span></span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> annual_summary, <span class="fu">aes</span>(year, area_wtd_anom)) <span class="sc">+</span></span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overlay yearly means and lines connecting them</span></span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">"Yearly Anomaly"</span>),  <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yearly Anomaly"</span> <span class="ot">=</span> <span class="st">"gray90"</span>)) <span class="sc">+</span></span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression lines for shifted baselines</span></span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textsegment</span>(</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> clim_avg,</span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend, <span class="at">y =</span> avg_anom_c, <span class="at">yend =</span> avg_anom_c),</span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"1982-2021 Climatological Average"</span>,</span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>),</span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.50</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textsegment</span>(</span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> r2_avg,</span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend, <span class="at">y =</span> avg_anom_c, <span class="at">yend =</span> avg_anom_c),</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"2010-2021 Average"</span>,</span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>, </span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"orange"</span>),</span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a>    <span class="co">#boxlinetype = "dotted", boxlinewidth = 0.5,</span></span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Axes</span></span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(</span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>     <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(</span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a>       <span class="at">trans =</span> <span class="sc">~</span><span class="fu">as_fahrenheit</span>(., <span class="at">data_type =</span> <span class="st">"anomalies"</span>),</span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span>  <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0F"</span>)),</span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>)) <span class="sc">+</span></span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labels + theme</span></span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recent Temperatures Indicative of a Regime Shift"</span>,</span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sea Surface Temperature Anomaly"</span>,</span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">"Anomalies calculated using 1982-2011 reference period."</span>)) <span class="sc">+</span></span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme</span></span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.1</span>),</span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="st">"transparent"</span>)) </span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a>The magnitude of this regime shift was <span class="in">`r r2_avg$avg_anom_c`</span>C, or <span class="in">`r r2_avg$avg_anom_f`</span>F. Bringing average yearly temperatures up from the 30-year average of <span class="in">`r clim_avg$avg_c`</span>C to <span class="in">`r r2_avg$avg_c`</span>C, or <span class="in">`r clim_avg$avg_f`</span>F to <span class="in">`r r2_avg$avg_f`</span>F.</span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Seasonal Patterns</span></span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=7}</span></span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Doing seasons by meteorological Definitions</span></span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a>quarter_summary <span class="ot">&lt;-</span> region_timeseries <span class="sc">%&gt;%</span> </span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1982</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> season_yr, season_eng) <span class="sc">%&gt;%</span> </span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sst =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> T),</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a>            <span class="at">sst_anom =</span> <span class="fu">mean</span>(sst_anom, <span class="at">na.rm =</span> T), </span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>            <span class="at">area_wtd_sst =</span> <span class="fu">mean</span>(area_wtd_sst, <span class="at">na.rm =</span> T),</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a>            <span class="at">area_wtd_anom =</span> <span class="fu">mean</span>(area_wtd_anom, <span class="at">na.rm =</span> T),</span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season_eng =</span> <span class="fu">factor</span>(season_eng, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Fall"</span>)))</span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a>quarter_summary <span class="sc">%&gt;%</span> </span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, area_wtd_anom)) <span class="sc">+</span></span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"gray60"</span>) <span class="sc">+</span></span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Regional Trend"</span>),</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> F, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"orange"</span>),</span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label..<span class="co">#, ..rr.label.., sep = "~~~"</span></span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>                                 )),</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a>               <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Regional Trend"</span> <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">gmri_cols</span>(<span class="st">"orange"</span>)))) <span class="sc">+</span></span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sea Surface Temperature Anomaly"</span>,</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Regression coefficients reflect annual change in sea surface temperature."</span>) <span class="sc">+</span></span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="at">trans =</span> <span class="sc">~</span><span class="fu">as_fahrenheit</span>(., <span class="at">data_type =</span> <span class="st">"anomalies"</span>),</span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">labels =</span>  <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0F"</span>)),</span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>)) <span class="sc">+</span></span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>),</span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">color =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>season_eng, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Overall Temperature Increase</span></span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=2.25}</span></span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a>dat_region <span class="ot">&lt;-</span> annual_summary <span class="sc">%&gt;%</span> </span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>)) </span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a>dat_global <span class="ot">&lt;-</span> global_summary <span class="sc">%&gt;%</span> </span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1982</span>, <span class="dv">2021</span>)) </span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(dat_region, dat_global) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(<span class="fu">c</span>(tidy_name, <span class="st">"Global Oceans"</span>))</span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>dat_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dat_list, <span class="at">.id =</span> <span class="st">"Area"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Area, area_wtd_sst, year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> area_wtd_sst)</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_combined, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">1982</span><span class="st">`</span>, <span class="at">xend =</span> <span class="st">`</span><span class="at">2021</span><span class="st">`</span>, <span class="at">y =</span> <span class="fu">fct_rev</span>(Area))) <span class="sc">+</span></span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dumbbell</span>(<span class="at">colour =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour_xend =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>), </span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>                <span class="at">dot_guide =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a>                <span class="at">dot_guide_size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">2021</span><span class="st">`</span>, <span class="at">y =</span> <span class="fu">fct_rev</span>(Area), </span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">"+"</span>, <span class="fu">round</span>(<span class="st">`</span><span class="at">2021</span><span class="st">`</span><span class="sc">-</span> <span class="st">`</span><span class="at">1982</span><span class="st">`</span>, <span class="dv">2</span>), <span class="st">" C"</span>)),</span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>),</span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a>                <span class="at">vjust =</span> <span class="dv">4</span>,</span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>                <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>                <span class="at">segment.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">123</span>) <span class="sc">+</span></span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sea Surface Temperature"</span>, </span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Change in Sea Surface Temeprature - 1982-2021"</span>, </span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="at">trans =</span> <span class="sc">~</span><span class="fu">as_fahrenheit</span>(., <span class="at">data_type =</span> <span class="st">"temperature"</span>),</span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">labels =</span>  <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0F"</span>)),</span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>))</span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marine Heatwaves {.tabset}</span></span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a>A marine heatwave is defined as a situation when seawater temperatures exceeds a seasonally-varying threshold (usually the 90th percentile) for at least 5 consecutive days. Successive heatwaves with gaps of 2 days or less are considered part of the same event. The heatwave threshold used below was 90%. The heatwave history for <span class="in">`r tidy_name`</span> is displayed below:</span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a>**Note:** For the figures below heatwave events were determined using the methods of Hobday et al. 2016 and implemented using the R package <span class="co">[</span><span class="ot">{heatwaveR}</span><span class="co">](https://robwschlegel.github.io/heatwaveR/)</span>.</span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Heatwave Events</span></span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height = 6}</span></span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap</span></span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a>heatwave_heatmap <span class="ot">&lt;-</span> <span class="fu">heatwave_heatmap_plot</span>(<span class="at">hw_dat =</span> grid_data, <span class="at">temp_units =</span> <span class="st">"C"</span>)</span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble pieces</span></span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a>heatwave_heatmap</span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Heatwave Trends</span></span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=8}</span></span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a><span class="do">#### Annual Heatwave Summary Details</span></span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a><span class="co"># number of heatwaves</span></span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a><span class="co"># average heatwave duration</span></span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NA as a distinct heatwave number</span></span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a>wave_summary <span class="ot">&lt;-</span> grid_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">year</span>(time), mhw_event_no) <span class="sc">%&gt;%</span> </span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_days =</span> <span class="fu">sum</span>(mhw_event, <span class="at">na.rm =</span> T),</span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a>              <span class="at">avg_anom =</span> <span class="fu">mean</span>(sst_anom, <span class="at">na.rm =</span> T),</span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a>              <span class="at">peak_anom =</span> <span class="fu">max</span>(sst_anom, <span class="at">na.rm =</span> T),</span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a>              <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="st">`</span><span class="at">year(time)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num_waves =</span> <span class="fu">n_distinct</span>(mhw_event_no),</span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a>              <span class="at">avg_length =</span> <span class="fu">mean</span>(total_days, <span class="at">na.rm =</span> T),</span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>              <span class="at">avg_intensity =</span> <span class="fu">mean</span>(avg_anom, <span class="at">na.rm =</span> T),</span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a>              <span class="at">peak_intensity =</span> <span class="fu">max</span>(peak_anom, <span class="at">na.rm =</span> T),</span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a>              <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year =</span> <span class="st">`</span><span class="at">year(time)</span><span class="st">`</span>)</span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a><span class="do">####  Plotting</span></span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a><span class="co"># number of heatwaves</span></span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a>hw_counts <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wave_summary, <span class="fu">aes</span>(<span class="at">y =</span> year, <span class="at">x =</span> num_waves)) <span class="sc">+</span></span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> year, <span class="at">xend =</span> <span class="dv">0</span>), </span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Event Count"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a><span class="co"># average duration</span></span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a>hw_lengths <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wave_summary, <span class="fu">aes</span>(<span class="at">y =</span> year, <span class="at">x =</span> avg_length)) <span class="sc">+</span></span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> year, <span class="at">xend =</span> <span class="dv">0</span>), </span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"orange"</span>)) <span class="sc">+</span></span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Event Duration"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a><span class="co"># avg temp</span></span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a>hw_temps <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wave_summary, <span class="fu">aes</span>(<span class="at">y =</span> year, <span class="at">x =</span> avg_intensity)) <span class="sc">+</span></span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> year, <span class="at">xend =</span> <span class="dv">0</span>), </span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Avg Anomaly"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a><span class="co"># peak temp</span></span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a>hw_peaks <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(wave_summary, <span class="fu">aes</span>(<span class="at">y =</span> year, <span class="at">x =</span> peak_intensity)) <span class="sc">+</span></span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> year, <span class="at">xend =</span> <span class="dv">0</span>), </span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"teal"</span>)) <span class="sc">+</span></span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"teal"</span>)) <span class="sc">+</span></span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Peak Anomaly"</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-792"><a href="#cb1-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-793"><a href="#cb1-793" aria-hidden="true" tabindex="-1"></a>(hw_counts <span class="sc">|</span> hw_lengths <span class="sc">|</span> hw_temps <span class="sc">|</span> hw_peaks) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Heatwaves Frequent and Powerful in Recent Years"</span>)</span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2: `r current_yr` Observations</span></span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a><span class="fu">### Temperatures of the Last Full Year (Interactive)</span></span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a>Daily temperatures for the last 365 days are displayed below with reference to how they fall against the marine heatwave and cold spell thresholds. </span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a><span class="co"># # Option 1: Grab last 365 days</span></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a><span class="co"># # Grab data from the most recent year through present day to plot</span></span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a><span class="co"># last_year &lt;- Sys.Date() - 365 #1 year from current date</span></span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a><span class="co"># last_yr_heatwaves &lt;- region_hw %&gt;% filter(time &gt;= last_year)</span></span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a><span class="co"># last_yr &lt;- year(last_yr)</span></span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a><span class="co"># # Option 2: Grab last Full Year:</span></span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a><span class="co"># last_year &lt;- Sys.Date() - 365 #1 year from current date</span></span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a><span class="co"># # wind it back to first day of the year</span></span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a><span class="co"># last_year &lt;- last_year - yday(last_year) + 1 </span></span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a><span class="co"># # Filter out:</span></span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a><span class="co"># last_yr_heatwaves &lt;- region_hw %&gt;% filter(year(time) == year(last_year))</span></span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a><span class="co"># last_yr &lt;- year(last_yr)</span></span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 3: Last complete year</span></span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a>last_year <span class="ot">&lt;-</span> <span class="dv">2021</span></span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a>last_yr_heatwaves <span class="ot">&lt;-</span>  region_hw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(time) <span class="sc">==</span> last_year)</span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a><span class="co"># Get number of heatwave events and total heatwave days for last year</span></span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a><span class="co"># How many heatwave events:</span></span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a><span class="co"># How many heatwave events</span></span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a>num_events   <span class="ot">&lt;-</span> <span class="fu">max</span>(last_yr_heatwaves<span class="sc">$</span>mhw_event_no, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="fu">min</span>(last_yr_heatwaves<span class="sc">$</span>mhw_event_no, <span class="at">na.rm =</span> T) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for only the current year</span></span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a>this_yr_hw <span class="ot">&lt;-</span> region_hw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(time) <span class="sc">==</span> <span class="fu">year</span>(<span class="fu">Sys.Date</span>()))</span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of heatwave events</span></span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a>num_hw_days <span class="ot">&lt;-</span> <span class="fu">sum</span>(this_yr_hw<span class="sc">$</span>mhw_event, <span class="at">na.rm =</span> T)</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mhw plotly}</span></span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the interactive timeseries</span></span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a>last_yr_heatwaves <span class="sc">%&gt;%</span> </span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotly_mhw_plots</span>()</span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a><span class="fu">### `r year(Sys.Date())` Temperatures</span></span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a>Temperatures for the current year can be seen against the same thresholds with the following plot:</span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mhw ggplot}</span></span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Plot</span></span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a>hw_temp_p <span class="ot">&lt;-</span> <span class="fu">year_hw_temps</span>(<span class="at">year_hw_dat =</span> this_yr_hw, <span class="at">temp_units =</span> <span class="st">"C"</span>)</span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a><span class="co"># Show Figure</span></span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a>hw_temp_p</span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a><span class="fu">###  `r year(Sys.Date())` Anomalies</span></span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a>Changing from absolute temperatures to anomalies reveals the degree to which this year is departure from what we would have expected from the climatology of 1982-2011's temperatures.</span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r heatwave anomaly timeline}</span></span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a><span class="co"># Show figure</span></span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a>hw_anom_p <span class="ot">&lt;-</span> <span class="fu">year_hw_anoms</span>(<span class="at">year_hw_dat =</span> this_yr_hw, <span class="at">temp_units =</span> <span class="st">"C"</span>)</span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a>hw_anom_p</span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a><span class="fu">### `r current_yr` in Context</span></span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a>When <span class="in">`r current_yr`</span> is overlaid against the daily values and climatological average for the region, we can see how temperatures compare to the history of the region.</span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot this year among all previous</span></span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a>this_yr_hw <span class="ot">&lt;-</span> this_yr_hw <span class="sc">%&gt;%</span> </span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yday =</span> <span class="fu">yday</span>(time),</span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a>         <span class="at">flat_date =</span> <span class="fu">as.Date</span>(<span class="st">"2000-01-01"</span>) <span class="sc">+</span> yday <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a plot</span></span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> one_yr, <span class="fu">aes</span>(<span class="at">x =</span> flat_date)) <span class="sc">+</span></span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> grid_data, <span class="fu">aes</span>(<span class="at">y =</span> sst, <span class="at">color =</span> <span class="st">"Daily Temperature"</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_textline</span>(</span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">y =</span> seas, </span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"Climatological Average"</span>, </span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"Climatological Average"</span>),</span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> this_yr_hw,  </span>
<span id="cb1-922"><a href="#cb1-922" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(flat_date, sst, <span class="at">color =</span> <span class="st">"2022 Temperatures"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-923"><a href="#cb1-923" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))) <span class="sc">+</span></span>
<span id="cb1-924"><a href="#cb1-924" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(</span>
<span id="cb1-925"><a href="#cb1-925" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb1-926"><a href="#cb1-926" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Daily Temperature"</span> <span class="ot">=</span> <span class="st">"gray80"</span>,</span>
<span id="cb1-927"><a href="#cb1-927" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Climatological Average"</span> <span class="ot">=</span> <span class="st">"gray10"</span>,</span>
<span id="cb1-928"><a href="#cb1-928" aria-hidden="true" tabindex="-1"></a>        <span class="st">"2022 Temperatures"</span><span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">gmri_cols</span>(<span class="st">"orange"</span>))</span>
<span id="cb1-929"><a href="#cb1-929" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-930"><a href="#cb1-930" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-931"><a href="#cb1-931" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">suffix =</span> <span class="st">" \u00b0C"</span>)) <span class="sc">+</span></span>
<span id="cb1-932"><a href="#cb1-932" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day of the Year"</span>, <span class="at">y =</span> <span class="st">"Sea Surface Temperature"</span>,</span>
<span id="cb1-933"><a href="#cb1-933" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">str_c</span>(current_yr, <span class="st">" Temperatures in Context of the Last 40-Years"</span>),</span>
<span id="cb1-934"><a href="#cb1-934" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Current year conditions suggest a persistance of warmer regime"</span>) <span class="sc">+</span></span>
<span id="cb1-935"><a href="#cb1-935" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_gmri() +</span></span>
<span id="cb1-936"><a href="#cb1-936" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-937"><a href="#cb1-937" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb1-938"><a href="#cb1-938" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb1-939"><a href="#cb1-939" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb1-940"><a href="#cb1-940" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(.<span class="dv">5</span>,<span class="dv">1</span>,.<span class="dv">3</span>,.<span class="dv">5</span>), <span class="st">"cm"</span>),</span>
<span id="cb1-941"><a href="#cb1-941" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb1-942"><a href="#cb1-942" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1-943"><a href="#cb1-943" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb1-944"><a href="#cb1-944" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb1-945"><a href="#cb1-945" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb1-946"><a href="#cb1-946" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-947"><a href="#cb1-947" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-948"><a href="#cb1-948" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.position =</span> <span class="st">"left"</span>,</span>
<span id="cb1-949"><a href="#cb1-949" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.position =</span> <span class="st">"top"</span>,</span>
<span id="cb1-950"><a href="#cb1-950" aria-hidden="true" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb1-951"><a href="#cb1-951" aria-hidden="true" tabindex="-1"></a>          <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb1-952"><a href="#cb1-952" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-953"><a href="#cb1-953" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb1-954"><a href="#cb1-954" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>)),</span>
<span id="cb1-955"><a href="#cb1-955" aria-hidden="true" tabindex="-1"></a>        <span class="at">byrow =</span> T))</span>
<span id="cb1-956"><a href="#cb1-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-957"><a href="#cb1-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-958"><a href="#cb1-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-959"><a href="#cb1-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-960"><a href="#cb1-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-961"><a href="#cb1-961" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3: Global Temperature Maps   </span></span>
<span id="cb1-962"><a href="#cb1-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-963"><a href="#cb1-963" aria-hidden="true" tabindex="-1"></a>The 2021 global sea surface temperature anomalies have been loaded and displayed below to visualize how different areas of the ocean experience swings in temperature.</span>
<span id="cb1-964"><a href="#cb1-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-965"><a href="#cb1-965" aria-hidden="true" tabindex="-1"></a>For perspective on where excess heat is distributed around the world, here first are maps of anomalies at a global perspective:</span>
<span id="cb1-966"><a href="#cb1-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-969"><a href="#cb1-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-970"><a href="#cb1-970" aria-hidden="true" tabindex="-1"></a><span class="co"># Access information to netcdf on box</span></span>
<span id="cb1-971"><a href="#cb1-971" aria-hidden="true" tabindex="-1"></a>nc_year <span class="ot">&lt;-</span> <span class="st">"2021"</span></span>
<span id="cb1-972"><a href="#cb1-972" aria-hidden="true" tabindex="-1"></a>anom_path <span class="ot">&lt;-</span> <span class="fu">str_c</span>(oisst_path, <span class="st">"annual_anomalies/1982to2011_climatology/daily_anoms_"</span>, nc_year, <span class="st">".nc"</span>)</span>
<span id="cb1-973"><a href="#cb1-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-974"><a href="#cb1-974" aria-hidden="true" tabindex="-1"></a><span class="co"># Load 2021 as stack</span></span>
<span id="cb1-975"><a href="#cb1-975" aria-hidden="true" tabindex="-1"></a>anoms_2021 <span class="ot">&lt;-</span> <span class="fu">stack</span>(anom_path)</span>
<span id="cb1-976"><a href="#cb1-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-977"><a href="#cb1-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-978"><a href="#cb1-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-979"><a href="#cb1-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-980"><a href="#cb1-980" aria-hidden="true" tabindex="-1"></a>:::{.panelset}</span>
<span id="cb1-981"><a href="#cb1-981" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-982"><a href="#cb1-982" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Average {.panel-name}</span></span>
<span id="cb1-983"><a href="#cb1-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-984"><a href="#cb1-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-987"><a href="#cb1-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-988"><a href="#cb1-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Annual Average</span></span>
<span id="cb1-989"><a href="#cb1-989" aria-hidden="true" tabindex="-1"></a>ann_anom_ras <span class="ot">&lt;-</span> <span class="fu">calc</span>(anoms_2021, <span class="at">fun =</span> mean, <span class="at">na.rm =</span> T)</span>
<span id="cb1-990"><a href="#cb1-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-991"><a href="#cb1-991" aria-hidden="true" tabindex="-1"></a><span class="co"># Color scale title</span></span>
<span id="cb1-992"><a href="#cb1-992" aria-hidden="true" tabindex="-1"></a>sst_lab <span class="ot">&lt;-</span> <span class="st">"Sea Surface Temperature Anomaly"</span></span>
<span id="cb1-993"><a href="#cb1-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-994"><a href="#cb1-994" aria-hidden="true" tabindex="-1"></a><span class="co"># Color limit for palettes</span></span>
<span id="cb1-995"><a href="#cb1-995" aria-hidden="true" tabindex="-1"></a>temp_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1-996"><a href="#cb1-996" aria-hidden="true" tabindex="-1"></a>temp_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(temp_limits[<span class="dv">1</span>], temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,  <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, temp_limits[<span class="dv">2</span>])</span>
<span id="cb1-997"><a href="#cb1-997" aria-hidden="true" tabindex="-1"></a>temp_labels <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">"&lt; "</span>, temp_limits[<span class="dv">1</span>]), temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="fu">str_c</span>(<span class="st">"&gt; "</span>, temp_limits[<span class="dv">2</span>])), <span class="st">"\u00b0C"</span>)</span>
<span id="cb1-998"><a href="#cb1-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-999"><a href="#cb1-999" aria-hidden="true" tabindex="-1"></a><span class="co"># Make st object</span></span>
<span id="cb1-1000"><a href="#cb1-1000" aria-hidden="true" tabindex="-1"></a>ann_anom_st <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(<span class="fu">rotate</span>(ann_anom_ras)) </span>
<span id="cb1-1001"><a href="#cb1-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1002"><a href="#cb1-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Map</span></span>
<span id="cb1-1003"><a href="#cb1-1003" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1004"><a href="#cb1-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stars</span>(<span class="at">data =</span> ann_anom_st) <span class="sc">+</span></span>
<span id="cb1-1005"><a href="#cb1-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1006"><a href="#cb1-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(</span>
<span id="cb1-1007"><a href="#cb1-1007" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"RdBu"</span>, </span>
<span id="cb1-1008"><a href="#cb1-1008" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1009"><a href="#cb1-1009" aria-hidden="true" tabindex="-1"></a>    <span class="at">limit =</span> temp_limits, </span>
<span id="cb1-1010"><a href="#cb1-1010" aria-hidden="true" tabindex="-1"></a>    <span class="at">oob =</span> scales<span class="sc">::</span>squish,</span>
<span id="cb1-1011"><a href="#cb1-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> temp_breaks, </span>
<span id="cb1-1012"><a href="#cb1-1012" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> temp_labels) <span class="sc">+</span></span>
<span id="cb1-1013"><a href="#cb1-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb1-1014"><a href="#cb1-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> sst_lab, </span>
<span id="cb1-1015"><a href="#cb1-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1016"><a href="#cb1-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1017"><a href="#cb1-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"inches"</span>), </span>
<span id="cb1-1018"><a href="#cb1-1018" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame.colour =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1019"><a href="#cb1-1019" aria-hidden="true" tabindex="-1"></a>    <span class="at">ticks.colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span>  </span>
<span id="cb1-1020"><a href="#cb1-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1021"><a href="#cb1-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>() <span class="sc">+</span></span>
<span id="cb1-1022"><a href="#cb1-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1023"><a href="#cb1-1023" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb1-1024"><a href="#cb1-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">str_c</span>(<span class="st">"Global Temperature Anomalies - "</span>, nc_year))</span>
<span id="cb1-1025"><a href="#cb1-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1026"><a href="#cb1-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1027"><a href="#cb1-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1028"><a href="#cb1-1028" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1029"><a href="#cb1-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1030"><a href="#cb1-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1031"><a href="#cb1-1031" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1032"><a href="#cb1-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">## Winter {.panel-name}</span></span>
<span id="cb1-1033"><a href="#cb1-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1036"><a href="#cb1-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1037"><a href="#cb1-1037" aria-hidden="true" tabindex="-1"></a><span class="do">#### Making Averages for Seasons</span></span>
<span id="cb1-1038"><a href="#cb1-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1039"><a href="#cb1-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># Get previous year winter</span></span>
<span id="cb1-1040"><a href="#cb1-1040" aria-hidden="true" tabindex="-1"></a>last_nc_yr <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nc_year) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb1-1041"><a href="#cb1-1041" aria-hidden="true" tabindex="-1"></a>last_yr_anom_path <span class="ot">&lt;-</span> <span class="fu">str_c</span>(oisst_path, <span class="st">"annual_anomalies/1982to2011_climatology/daily_anoms_"</span>, last_nc_yr, <span class="st">".nc"</span>)</span>
<span id="cb1-1042"><a href="#cb1-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1043"><a href="#cb1-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># Load 2020 as stack to get the full winter</span></span>
<span id="cb1-1044"><a href="#cb1-1044" aria-hidden="true" tabindex="-1"></a>last_yr_anoms <span class="ot">&lt;-</span> <span class="fu">stack</span>(last_yr_anom_path)</span>
<span id="cb1-1045"><a href="#cb1-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1046"><a href="#cb1-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Join to 2021</span></span>
<span id="cb1-1047"><a href="#cb1-1047" aria-hidden="true" tabindex="-1"></a>anoms_double <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">list</span>(last_yr_anoms, anoms_2021))</span>
<span id="cb1-1048"><a href="#cb1-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1049"><a href="#cb1-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1050"><a href="#cb1-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop december 2021 so its not influencing the Winter of 2020-2021</span></span>
<span id="cb1-1051"><a href="#cb1-1051" aria-hidden="true" tabindex="-1"></a>dec_2021 <span class="ot">&lt;-</span> <span class="st">"X2021.12"</span></span>
<span id="cb1-1052"><a href="#cb1-1052" aria-hidden="true" tabindex="-1"></a>not_dec21 <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">str_sub</span>(<span class="fu">names</span>(anoms_double), <span class="dv">1</span>, <span class="dv">8</span>) <span class="sc">!=</span> dec_2021)</span>
<span id="cb1-1053"><a href="#cb1-1053" aria-hidden="true" tabindex="-1"></a>anoms_nodec <span class="ot">&lt;-</span> anoms_double[[not_dec21]]</span>
<span id="cb1-1054"><a href="#cb1-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1055"><a href="#cb1-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1056"><a href="#cb1-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up list to use map()</span></span>
<span id="cb1-1057"><a href="#cb1-1057" aria-hidden="true" tabindex="-1"></a>month_key <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Winter"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"12"</span>, <span class="st">"01"</span>, <span class="st">"02"</span>),</span>
<span id="cb1-1058"><a href="#cb1-1058" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Spring"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"03"</span>, <span class="st">"04"</span>, <span class="st">"05"</span>),</span>
<span id="cb1-1059"><a href="#cb1-1059" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Summer"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"06"</span>, <span class="st">"07"</span>, <span class="st">"08"</span>),</span>
<span id="cb1-1060"><a href="#cb1-1060" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Fall"</span>   <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"09"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>))</span>
<span id="cb1-1061"><a href="#cb1-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1062"><a href="#cb1-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1063"><a href="#cb1-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1064"><a href="#cb1-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#  Get mean anoms across seasons</span></span>
<span id="cb1-1065"><a href="#cb1-1065" aria-hidden="true" tabindex="-1"></a>season_stacks <span class="ot">&lt;-</span> <span class="fu">map</span>(month_key, <span class="cf">function</span>(mon){</span>
<span id="cb1-1066"><a href="#cb1-1066" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1067"><a href="#cb1-1067" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get names from the stack</span></span>
<span id="cb1-1068"><a href="#cb1-1068" aria-hidden="true" tabindex="-1"></a>  stack_names <span class="ot">&lt;-</span> <span class="fu">names</span>(anoms_nodec)</span>
<span id="cb1-1069"><a href="#cb1-1069" aria-hidden="true" tabindex="-1"></a>  stack_months <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(stack_names, <span class="dv">7</span>,<span class="dv">8</span>)</span>
<span id="cb1-1070"><a href="#cb1-1070" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1071"><a href="#cb1-1071" aria-hidden="true" tabindex="-1"></a>  <span class="co"># layers with correct months:</span></span>
<span id="cb1-1072"><a href="#cb1-1072" aria-hidden="true" tabindex="-1"></a>  in_season <span class="ot">&lt;-</span> <span class="fu">which</span>(stack_months <span class="sc">%in%</span> mon)</span>
<span id="cb1-1073"><a href="#cb1-1073" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1074"><a href="#cb1-1074" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get mean across those months</span></span>
<span id="cb1-1075"><a href="#cb1-1075" aria-hidden="true" tabindex="-1"></a>  season_mean <span class="ot">&lt;-</span> <span class="fu">calc</span>(anoms_nodec[[in_season]], mean, <span class="at">na.rm =</span> T)</span>
<span id="cb1-1076"><a href="#cb1-1076" aria-hidden="true" tabindex="-1"></a>  <span class="co"># season_mean &lt;- st_as_stars(rotate(season_mean))</span></span>
<span id="cb1-1077"><a href="#cb1-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(season_mean)</span>
<span id="cb1-1078"><a href="#cb1-1078" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1079"><a href="#cb1-1079" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1080"><a href="#cb1-1080" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-1081"><a href="#cb1-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1082"><a href="#cb1-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1083"><a href="#cb1-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1086"><a href="#cb1-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1087"><a href="#cb1-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the seasons</span></span>
<span id="cb1-1088"><a href="#cb1-1088" aria-hidden="true" tabindex="-1"></a>seas_anom_maps <span class="ot">&lt;-</span> <span class="cf">function</span>(season, lab_years, <span class="at">temp_lim =</span> <span class="dv">5</span>){</span>
<span id="cb1-1089"><a href="#cb1-1089" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1090"><a href="#cb1-1090" aria-hidden="true" tabindex="-1"></a>  <span class="co">#temp_limits &lt;- max(abs(values(season_stacks[[season]])), na.rm = T) * c(-1,1) </span></span>
<span id="cb1-1091"><a href="#cb1-1091" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1092"><a href="#cb1-1092" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center the color scale with Dynamic Limits</span></span>
<span id="cb1-1093"><a href="#cb1-1093" aria-hidden="true" tabindex="-1"></a>  temp_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> temp_lim</span>
<span id="cb1-1094"><a href="#cb1-1094" aria-hidden="true" tabindex="-1"></a>  temp_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(temp_limits[<span class="dv">1</span>], temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,  <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, temp_limits[<span class="dv">2</span>])</span>
<span id="cb1-1095"><a href="#cb1-1095" aria-hidden="true" tabindex="-1"></a>  temp_labels <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">"&lt; "</span>, temp_limits[<span class="dv">1</span>]), temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="fu">str_c</span>(<span class="st">"&gt; "</span>, temp_limits[<span class="dv">2</span>])), <span class="st">"\u00b0C"</span>)</span>
<span id="cb1-1096"><a href="#cb1-1096" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1097"><a href="#cb1-1097" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make map</span></span>
<span id="cb1-1098"><a href="#cb1-1098" aria-hidden="true" tabindex="-1"></a>  seas_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1099"><a href="#cb1-1099" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_stars</span>(<span class="at">data =</span> <span class="fu">st_as_stars</span>(<span class="fu">rotate</span>(season_stacks[[season]]))) <span class="sc">+</span></span>
<span id="cb1-1100"><a href="#cb1-1100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> world, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1101"><a href="#cb1-1101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, </span>
<span id="cb1-1102"><a href="#cb1-1102" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1103"><a href="#cb1-1103" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limit =</span> temp_limits, </span>
<span id="cb1-1104"><a href="#cb1-1104" aria-hidden="true" tabindex="-1"></a>                     <span class="at">oob =</span> scales<span class="sc">::</span>squish,</span>
<span id="cb1-1105"><a href="#cb1-1105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> temp_breaks, </span>
<span id="cb1-1106"><a href="#cb1-1106" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> temp_labels) <span class="sc">+</span></span>
<span id="cb1-1107"><a href="#cb1-1107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> sst_lab, </span>
<span id="cb1-1108"><a href="#cb1-1108" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1109"><a href="#cb1-1109" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1110"><a href="#cb1-1110" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"inches"</span>), </span>
<span id="cb1-1111"><a href="#cb1-1111" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">frame.colour =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1112"><a href="#cb1-1112" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ticks.colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span>  </span>
<span id="cb1-1113"><a href="#cb1-1113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1114"><a href="#cb1-1114" aria-hidden="true" tabindex="-1"></a>   <span class="fu">map_theme</span>() <span class="sc">+</span></span>
<span id="cb1-1115"><a href="#cb1-1115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1116"><a href="#cb1-1116" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb1-1117"><a href="#cb1-1117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">str_c</span>(season, <span class="st">": "</span>, lab_years))</span>
<span id="cb1-1118"><a href="#cb1-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(seas_map)</span>
<span id="cb1-1119"><a href="#cb1-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1120"><a href="#cb1-1120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1121"><a href="#cb1-1121" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1122"><a href="#cb1-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1123"><a href="#cb1-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1124"><a href="#cb1-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1127"><a href="#cb1-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1128"><a href="#cb1-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">seas_anom_maps</span>(<span class="st">"Winter"</span>, <span class="st">"2020-2021"</span>, <span class="at">temp_lim =</span> <span class="dv">2</span>)</span>
<span id="cb1-1129"><a href="#cb1-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1130"><a href="#cb1-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1131"><a href="#cb1-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1132"><a href="#cb1-1132" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1133"><a href="#cb1-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1134"><a href="#cb1-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1135"><a href="#cb1-1135" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1136"><a href="#cb1-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spring {.panel-name}</span></span>
<span id="cb1-1137"><a href="#cb1-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1138"><a href="#cb1-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1141"><a href="#cb1-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1142"><a href="#cb1-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">seas_anom_maps</span>(<span class="st">"Spring"</span>, <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="dv">2</span>)</span>
<span id="cb1-1143"><a href="#cb1-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1144"><a href="#cb1-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1145"><a href="#cb1-1145" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1146"><a href="#cb1-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1147"><a href="#cb1-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1148"><a href="#cb1-1148" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1149"><a href="#cb1-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summer {.panel-name}</span></span>
<span id="cb1-1150"><a href="#cb1-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1151"><a href="#cb1-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1154"><a href="#cb1-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1155"><a href="#cb1-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">seas_anom_maps</span>(<span class="st">"Summer"</span>, <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="dv">2</span>)</span>
<span id="cb1-1156"><a href="#cb1-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1157"><a href="#cb1-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1158"><a href="#cb1-1158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1159"><a href="#cb1-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1160"><a href="#cb1-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1161"><a href="#cb1-1161" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1162"><a href="#cb1-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fall {.panel-name}</span></span>
<span id="cb1-1163"><a href="#cb1-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1164"><a href="#cb1-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1167"><a href="#cb1-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1168"><a href="#cb1-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">seas_anom_maps</span>(<span class="st">"Fall"</span>, <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="dv">2</span>)</span>
<span id="cb1-1169"><a href="#cb1-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1170"><a href="#cb1-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1171"><a href="#cb1-1171" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1172"><a href="#cb1-1172" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1173"><a href="#cb1-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1174"><a href="#cb1-1174" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4: Regional Temperature Maps </span></span>
<span id="cb1-1175"><a href="#cb1-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1176"><a href="#cb1-1176" aria-hidden="true" tabindex="-1"></a>The regional views of 2021's sea surface temperature anomalies have been loaded and displayed below to visualize how localized differences changed throughout the year.</span>
<span id="cb1-1177"><a href="#cb1-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1178"><a href="#cb1-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1181"><a href="#cb1-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1182"><a href="#cb1-1182" aria-hidden="true" tabindex="-1"></a><span class="co"># # Expand the area out to see the larger patterns</span></span>
<span id="cb1-1183"><a href="#cb1-1183" aria-hidden="true" tabindex="-1"></a>crop_x <span class="ot">&lt;-</span> crop_x <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb1-1184"><a href="#cb1-1184" aria-hidden="true" tabindex="-1"></a>crop_y <span class="ot">&lt;-</span> crop_y <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb1-1185"><a href="#cb1-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1186"><a href="#cb1-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a new extent for cropping</span></span>
<span id="cb1-1187"><a href="#cb1-1187" aria-hidden="true" tabindex="-1"></a>region_extent_expanded <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(<span class="fu">st_polygon</span>(<span class="fu">list</span>(</span>
<span id="cb1-1188"><a href="#cb1-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">c</span>(crop_x[[<span class="dv">1</span>]], crop_y[[<span class="dv">1</span>]]),  </span>
<span id="cb1-1189"><a href="#cb1-1189" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(crop_x[[<span class="dv">1</span>]], crop_y[[<span class="dv">2</span>]]), </span>
<span id="cb1-1190"><a href="#cb1-1190" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(crop_x[[<span class="dv">2</span>]], crop_y[[<span class="dv">2</span>]]), </span>
<span id="cb1-1191"><a href="#cb1-1191" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(crop_x[[<span class="dv">2</span>]], crop_y[[<span class="dv">1</span>]]), </span>
<span id="cb1-1192"><a href="#cb1-1192" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(crop_x[[<span class="dv">1</span>]], crop_y[[<span class="dv">1</span>]])))))</span>
<span id="cb1-1193"><a href="#cb1-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1194"><a href="#cb1-1194" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to sf</span></span>
<span id="cb1-1195"><a href="#cb1-1195" aria-hidden="true" tabindex="-1"></a>region_extent_expanded <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(region_extent_expanded)</span>
<span id="cb1-1196"><a href="#cb1-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1197"><a href="#cb1-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1198"><a href="#cb1-1198" aria-hidden="true" tabindex="-1"></a>:::{.panelset}</span>
<span id="cb1-1199"><a href="#cb1-1199" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1200"><a href="#cb1-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Average {.panel-name}</span></span>
<span id="cb1-1201"><a href="#cb1-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1202"><a href="#cb1-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1205"><a href="#cb1-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1206"><a href="#cb1-1206" aria-hidden="true" tabindex="-1"></a><span class="co"># Mask the annual average</span></span>
<span id="cb1-1207"><a href="#cb1-1207" aria-hidden="true" tabindex="-1"></a>reg_ann_anom <span class="ot">&lt;-</span> <span class="fu">mask_nc</span>(<span class="at">ras_obj =</span> ann_anom_ras, <span class="at">mask_shape =</span> region_extent_expanded)</span>
<span id="cb1-1208"><a href="#cb1-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1209"><a href="#cb1-1209" aria-hidden="true" tabindex="-1"></a><span class="co"># Color limit for palettes</span></span>
<span id="cb1-1210"><a href="#cb1-1210" aria-hidden="true" tabindex="-1"></a>temp_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb1-1211"><a href="#cb1-1211" aria-hidden="true" tabindex="-1"></a>temp_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(temp_limits[<span class="dv">1</span>], temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,  <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, temp_limits[<span class="dv">2</span>])</span>
<span id="cb1-1212"><a href="#cb1-1212" aria-hidden="true" tabindex="-1"></a>temp_labels <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">"&lt; "</span>, temp_limits[<span class="dv">1</span>]), temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="fu">str_c</span>(<span class="st">"&gt; "</span>, temp_limits[<span class="dv">2</span>])), <span class="st">"\u00b0C"</span>)</span>
<span id="cb1-1213"><a href="#cb1-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1214"><a href="#cb1-1214" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Map</span></span>
<span id="cb1-1215"><a href="#cb1-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1216"><a href="#cb1-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stars</span>(<span class="at">data =</span> <span class="fu">st_as_stars</span>(reg_ann_anom)) <span class="sc">+</span></span>
<span id="cb1-1217"><a href="#cb1-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> new_england, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1218"><a href="#cb1-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> canada, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1219"><a href="#cb1-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> greenland, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1220"><a href="#cb1-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, </span>
<span id="cb1-1221"><a href="#cb1-1221" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1222"><a href="#cb1-1222" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limit =</span> temp_limits, </span>
<span id="cb1-1223"><a href="#cb1-1223" aria-hidden="true" tabindex="-1"></a>                     <span class="at">oob =</span> scales<span class="sc">::</span>squish,</span>
<span id="cb1-1224"><a href="#cb1-1224" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> temp_breaks, </span>
<span id="cb1-1225"><a href="#cb1-1225" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> temp_labels) <span class="sc">+</span></span>
<span id="cb1-1226"><a href="#cb1-1226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> sst_lab, </span>
<span id="cb1-1227"><a href="#cb1-1227" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1228"><a href="#cb1-1228" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1229"><a href="#cb1-1229" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"inches"</span>), </span>
<span id="cb1-1230"><a href="#cb1-1230" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">frame.colour =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1231"><a href="#cb1-1231" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ticks.colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span>  </span>
<span id="cb1-1232"><a href="#cb1-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>() <span class="sc">+</span></span>
<span id="cb1-1233"><a href="#cb1-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1234"><a href="#cb1-1234" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb1-1235"><a href="#cb1-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> crop_x, </span>
<span id="cb1-1236"><a href="#cb1-1236" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> crop_y, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1237"><a href="#cb1-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">str_c</span>(<span class="st">"Regional Temperature Anomalies - "</span>, nc_year))</span>
<span id="cb1-1238"><a href="#cb1-1238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1239"><a href="#cb1-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1240"><a href="#cb1-1240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1241"><a href="#cb1-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1242"><a href="#cb1-1242" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1243"><a href="#cb1-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Winter {.panel-name}</span></span>
<span id="cb1-1244"><a href="#cb1-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1247"><a href="#cb1-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1248"><a href="#cb1-1248" aria-hidden="true" tabindex="-1"></a><span class="co"># Mask the Seasons</span></span>
<span id="cb1-1249"><a href="#cb1-1249" aria-hidden="true" tabindex="-1"></a>seasons_masked <span class="ot">&lt;-</span> <span class="fu">map</span>(season_stacks, mask_nc, region_extent_expanded)</span>
<span id="cb1-1250"><a href="#cb1-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1251"><a href="#cb1-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the seasons</span></span>
<span id="cb1-1252"><a href="#cb1-1252" aria-hidden="true" tabindex="-1"></a>plot_masked_season <span class="ot">&lt;-</span> <span class="cf">function</span>(season, year_lab, <span class="at">temp_lim =</span> <span class="dv">5</span>){</span>
<span id="cb1-1253"><a href="#cb1-1253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1254"><a href="#cb1-1254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab Season</span></span>
<span id="cb1-1255"><a href="#cb1-1255" aria-hidden="true" tabindex="-1"></a>  reg_seas_anom <span class="ot">&lt;-</span> seasons_masked[[season]]</span>
<span id="cb1-1256"><a href="#cb1-1256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1257"><a href="#cb1-1257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get temp limits</span></span>
<span id="cb1-1258"><a href="#cb1-1258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># temp_limits &lt;- max(abs(values(reg_seas_anom)), na.rm = T) * c(-1,1) # Dynamic Limits</span></span>
<span id="cb1-1259"><a href="#cb1-1259" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Color limit for palettes</span></span>
<span id="cb1-1260"><a href="#cb1-1260" aria-hidden="true" tabindex="-1"></a>  temp_limits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> temp_lim</span>
<span id="cb1-1261"><a href="#cb1-1261" aria-hidden="true" tabindex="-1"></a>  temp_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(temp_limits[<span class="dv">1</span>], temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>,  <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, temp_limits[<span class="dv">2</span>])</span>
<span id="cb1-1262"><a href="#cb1-1262" aria-hidden="true" tabindex="-1"></a>  temp_labels <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">"&lt; "</span>, temp_limits[<span class="dv">1</span>]), temp_limits[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, temp_limits[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">2</span>, <span class="fu">str_c</span>(<span class="st">"&gt; "</span>, temp_limits[<span class="dv">2</span>])), <span class="st">"\u00b0C"</span>)</span>
<span id="cb1-1263"><a href="#cb1-1263" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1264"><a href="#cb1-1264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1265"><a href="#cb1-1265" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build Map</span></span>
<span id="cb1-1266"><a href="#cb1-1266" aria-hidden="true" tabindex="-1"></a>  seas_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1267"><a href="#cb1-1267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_stars</span>(<span class="at">data =</span> <span class="fu">st_as_stars</span>(reg_seas_anom)) <span class="sc">+</span></span>
<span id="cb1-1268"><a href="#cb1-1268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> new_england, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1269"><a href="#cb1-1269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> canada, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1270"><a href="#cb1-1270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> greenland, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1271"><a href="#cb1-1271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, </span>
<span id="cb1-1272"><a href="#cb1-1272" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1273"><a href="#cb1-1273" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limit =</span> temp_limits, </span>
<span id="cb1-1274"><a href="#cb1-1274" aria-hidden="true" tabindex="-1"></a>                     <span class="at">oob =</span> scales<span class="sc">::</span>squish,</span>
<span id="cb1-1275"><a href="#cb1-1275" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> temp_breaks, </span>
<span id="cb1-1276"><a href="#cb1-1276" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> temp_labels) <span class="sc">+</span></span>
<span id="cb1-1277"><a href="#cb1-1277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> sst_lab, </span>
<span id="cb1-1278"><a href="#cb1-1278" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1279"><a href="#cb1-1279" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1280"><a href="#cb1-1280" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"inches"</span>), </span>
<span id="cb1-1281"><a href="#cb1-1281" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">frame.colour =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1282"><a href="#cb1-1282" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ticks.colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span>  </span>
<span id="cb1-1283"><a href="#cb1-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>() <span class="sc">+</span></span>
<span id="cb1-1284"><a href="#cb1-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, </span>
<span id="cb1-1285"><a href="#cb1-1285" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb1-1286"><a href="#cb1-1286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> crop_x, </span>
<span id="cb1-1287"><a href="#cb1-1287" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> crop_y, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1288"><a href="#cb1-1288" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">str_c</span>(season, <span class="st">" - "</span>, year_lab))</span>
<span id="cb1-1289"><a href="#cb1-1289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1290"><a href="#cb1-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(seas_map)</span>
<span id="cb1-1291"><a href="#cb1-1291" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1292"><a href="#cb1-1292" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1293"><a href="#cb1-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1294"><a href="#cb1-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1295"><a href="#cb1-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1296"><a href="#cb1-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1297"><a href="#cb1-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1300"><a href="#cb1-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1301"><a href="#cb1-1301" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_masked_season</span>(<span class="st">"Winter"</span>, <span class="at">year_lab =</span> <span class="st">"2020-2021"</span>, <span class="at">temp_lim =</span> <span class="fl">3.5</span>)</span>
<span id="cb1-1302"><a href="#cb1-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1303"><a href="#cb1-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1304"><a href="#cb1-1304" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1305"><a href="#cb1-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1306"><a href="#cb1-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1307"><a href="#cb1-1307" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1308"><a href="#cb1-1308" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spring {.panel-name}</span></span>
<span id="cb1-1309"><a href="#cb1-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1312"><a href="#cb1-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1313"><a href="#cb1-1313" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_masked_season</span>(<span class="st">"Spring"</span>, <span class="at">year_lab =</span> <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="fl">3.5</span>)</span>
<span id="cb1-1314"><a href="#cb1-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1315"><a href="#cb1-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1316"><a href="#cb1-1316" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1317"><a href="#cb1-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1318"><a href="#cb1-1318" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1319"><a href="#cb1-1319" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summer {.panel-name}</span></span>
<span id="cb1-1320"><a href="#cb1-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1321"><a href="#cb1-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1324"><a href="#cb1-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1325"><a href="#cb1-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_masked_season</span>(<span class="st">"Summer"</span>, <span class="at">year_lab =</span> <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="fl">3.5</span>)</span>
<span id="cb1-1326"><a href="#cb1-1326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1327"><a href="#cb1-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1328"><a href="#cb1-1328" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1329"><a href="#cb1-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1330"><a href="#cb1-1330" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1331"><a href="#cb1-1331" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fall {.panel-name}</span></span>
<span id="cb1-1332"><a href="#cb1-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1333"><a href="#cb1-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1336"><a href="#cb1-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1337"><a href="#cb1-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_masked_season</span>(<span class="st">"Fall"</span>, <span class="at">year_lab =</span> <span class="st">"2021"</span>, <span class="at">temp_lim =</span> <span class="fl">3.5</span>)</span>
<span id="cb1-1338"><a href="#cb1-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1339"><a href="#cb1-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1340"><a href="#cb1-1340" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1341"><a href="#cb1-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1342"><a href="#cb1-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1343"><a href="#cb1-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1344"><a href="#cb1-1344" aria-hidden="true" tabindex="-1"></a>::: {.panel}</span>
<span id="cb1-1345"><a href="#cb1-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Heatwave Progression {.panel-name}</span></span>
<span id="cb1-1346"><a href="#cb1-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1347"><a href="#cb1-1347" aria-hidden="true" tabindex="-1"></a>Looking specifically at the last heatwave event, we can step through how the event progressed over time, and developing pockets or warmer/colder water masses.</span>
<span id="cb1-1348"><a href="#cb1-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1349"><a href="#cb1-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r hw progression, eval = F}</span></span>
<span id="cb1-1350"><a href="#cb1-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1351"><a href="#cb1-1351" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the last heatwave event that happened</span></span>
<span id="cb1-1352"><a href="#cb1-1352" aria-hidden="true" tabindex="-1"></a>last_event <span class="ot">&lt;-</span> <span class="fu">max</span>(region_hw<span class="sc">$</span>mhw_event_no, <span class="at">na.rm =</span> T)</span>
<span id="cb1-1353"><a href="#cb1-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1354"><a href="#cb1-1354" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull the dates of the most recent heatwave</span></span>
<span id="cb1-1355"><a href="#cb1-1355" aria-hidden="true" tabindex="-1"></a>last_event_dates <span class="ot">&lt;-</span> region_hw <span class="sc">%&gt;%</span> </span>
<span id="cb1-1356"><a href="#cb1-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mhw_event_no <span class="sc">==</span> last_event) <span class="sc">%&gt;%</span> </span>
<span id="cb1-1357"><a href="#cb1-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(time)</span>
<span id="cb1-1358"><a href="#cb1-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1359"><a href="#cb1-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1360"><a href="#cb1-1360" aria-hidden="true" tabindex="-1"></a><span class="co"># Buffer the dates, start 7 days before</span></span>
<span id="cb1-1361"><a href="#cb1-1361" aria-hidden="true" tabindex="-1"></a>event_start <span class="ot">&lt;-</span> (<span class="fu">min</span>(last_event_dates) <span class="sc">-</span> <span class="dv">7</span>)</span>
<span id="cb1-1362"><a href="#cb1-1362" aria-hidden="true" tabindex="-1"></a>event_stop  <span class="ot">&lt;-</span> <span class="fu">max</span>(last_event_dates)</span>
<span id="cb1-1363"><a href="#cb1-1363" aria-hidden="true" tabindex="-1"></a>date_seq <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> event_start,</span>
<span id="cb1-1364"><a href="#cb1-1364" aria-hidden="true" tabindex="-1"></a>                     <span class="at">to   =</span> event_stop,</span>
<span id="cb1-1365"><a href="#cb1-1365" aria-hidden="true" tabindex="-1"></a>                     <span class="at">by   =</span> <span class="dv">1</span>)</span>
<span id="cb1-1366"><a href="#cb1-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1367"><a href="#cb1-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1368"><a href="#cb1-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1369"><a href="#cb1-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the heatwave dates</span></span>
<span id="cb1-1370"><a href="#cb1-1370" aria-hidden="true" tabindex="-1"></a>data_window <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-1371"><a href="#cb1-1371" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">c</span>(<span class="fu">min</span>(date_seq) , <span class="fu">max</span>(date_seq) ),</span>
<span id="cb1-1372"><a href="#cb1-1372" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon  =</span> crop_x,</span>
<span id="cb1-1373"><a href="#cb1-1373" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat  =</span> crop_y)</span>
<span id="cb1-1374"><a href="#cb1-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1375"><a href="#cb1-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1376"><a href="#cb1-1376" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull data off box</span></span>
<span id="cb1-1377"><a href="#cb1-1377" aria-hidden="true" tabindex="-1"></a>hw_stack <span class="ot">&lt;-</span> <span class="fu">oisst_window_load</span>(<span class="at">data_window =</span> data_window, </span>
<span id="cb1-1378"><a href="#cb1-1378" aria-hidden="true" tabindex="-1"></a>                              <span class="at">anomalies =</span> T, <span class="at">mac_os =</span> <span class="st">"mojave"</span>)</span>
<span id="cb1-1379"><a href="#cb1-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1380"><a href="#cb1-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1381"><a href="#cb1-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#drop any empty years that bug in</span></span>
<span id="cb1-1382"><a href="#cb1-1382" aria-hidden="true" tabindex="-1"></a>hw_stack <span class="ot">&lt;-</span> hw_stack[<span class="fu">map</span>(hw_stack, class) <span class="sc">!=</span> <span class="st">"character"</span>]</span>
<span id="cb1-1383"><a href="#cb1-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1384"><a href="#cb1-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1385"><a href="#cb1-1385" aria-hidden="true" tabindex="-1"></a><span class="do">##### Format the layers and loop through the maps  ####</span></span>
<span id="cb1-1386"><a href="#cb1-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1387"><a href="#cb1-1387" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab only current year, format dates</span></span>
<span id="cb1-1388"><a href="#cb1-1388" aria-hidden="true" tabindex="-1"></a>this_yr   <span class="ot">&lt;-</span> <span class="fu">stack</span>(hw_stack)</span>
<span id="cb1-1389"><a href="#cb1-1389" aria-hidden="true" tabindex="-1"></a>day_count <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">names</span>(this_yr))</span>
<span id="cb1-1390"><a href="#cb1-1390" aria-hidden="true" tabindex="-1"></a>day_labs  <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="fu">names</span>(this_yr), <span class="st">"[.]"</span>,<span class="st">"-"</span>)</span>
<span id="cb1-1391"><a href="#cb1-1391" aria-hidden="true" tabindex="-1"></a>day_labs  <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(day_labs, <span class="st">"X"</span>, <span class="st">""</span>)</span>
<span id="cb1-1392"><a href="#cb1-1392" aria-hidden="true" tabindex="-1"></a>day_count <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>day_count) <span class="sc">%&gt;%</span> <span class="fu">setNames</span>(day_labs)</span>
<span id="cb1-1393"><a href="#cb1-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1394"><a href="#cb1-1394" aria-hidden="true" tabindex="-1"></a><span class="co"># Progress through daily timeline to indicate heatwave status and severity</span></span>
<span id="cb1-1395"><a href="#cb1-1395" aria-hidden="true" tabindex="-1"></a>hw_timeline <span class="ot">&lt;-</span> region_hw <span class="sc">%&gt;%</span> </span>
<span id="cb1-1396"><a href="#cb1-1396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">%in%</span> <span class="fu">as.Date</span>(day_labs))</span>
<span id="cb1-1397"><a href="#cb1-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1398"><a href="#cb1-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1399"><a href="#cb1-1399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1400"><a href="#cb1-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1401"><a href="#cb1-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1402"><a href="#cb1-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1403"><a href="#cb1-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r hw progression animation, eval = F, animation.hook = 'gifski', fig.height=8, fig.width=9}</span></span>
<span id="cb1-1404"><a href="#cb1-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1405"><a href="#cb1-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1406"><a href="#cb1-1406" aria-hidden="true" tabindex="-1"></a><span class="do">####  Plot Settings:</span></span>
<span id="cb1-1407"><a href="#cb1-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1408"><a href="#cb1-1408" aria-hidden="true" tabindex="-1"></a><span class="co"># Set palette limits to center it on 0 with scale_fill_distiller</span></span>
<span id="cb1-1409"><a href="#cb1-1409" aria-hidden="true" tabindex="-1"></a>limit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(<span class="fu">values</span>(this_yr), <span class="at">na.rm =</span> T) <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb1-1410"><a href="#cb1-1410" aria-hidden="true" tabindex="-1"></a>           <span class="fu">max</span>(<span class="fu">values</span>(this_yr), <span class="at">na.rm =</span> T) )</span>
<span id="cb1-1411"><a href="#cb1-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1412"><a href="#cb1-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1413"><a href="#cb1-1413" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Heatwave 1 day at a time as a GIF</span></span>
<span id="cb1-1414"><a href="#cb1-1414" aria-hidden="true" tabindex="-1"></a>day_plots <span class="ot">&lt;-</span> <span class="fu">imap</span>(day_count, <span class="cf">function</span>(date_index, date_label) {</span>
<span id="cb1-1415"><a href="#cb1-1415" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1416"><a href="#cb1-1416" aria-hidden="true" tabindex="-1"></a>  <span class="co"># grab dates</span></span>
<span id="cb1-1417"><a href="#cb1-1417" aria-hidden="true" tabindex="-1"></a>  heatwaves_st  <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(this_yr[[date_index]])</span>
<span id="cb1-1418"><a href="#cb1-1418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1419"><a href="#cb1-1419" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### 1. Map the Anomalies in Space</span></span>
<span id="cb1-1420"><a href="#cb1-1420" aria-hidden="true" tabindex="-1"></a>  day_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1421"><a href="#cb1-1421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_stars</span>(<span class="at">data =</span> heatwaves_st) <span class="sc">+</span></span>
<span id="cb1-1422"><a href="#cb1-1422" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> new_england, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1423"><a href="#cb1-1423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> canada, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1424"><a href="#cb1-1424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> greenland, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1425"><a href="#cb1-1425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_union</span>(region_extent), </span>
<span id="cb1-1426"><a href="#cb1-1426" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>), </span>
<span id="cb1-1427"><a href="#cb1-1427" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb1-1428"><a href="#cb1-1428" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb1-1429"><a href="#cb1-1429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdYlBu"</span>, </span>
<span id="cb1-1430"><a href="#cb1-1430" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1431"><a href="#cb1-1431" aria-hidden="true" tabindex="-1"></a>                         <span class="at">limit =</span> limit) <span class="sc">+</span></span>
<span id="cb1-1432"><a href="#cb1-1432" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-1433"><a href="#cb1-1433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">xlim =</span> crop_x, </span>
<span id="cb1-1434"><a href="#cb1-1434" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim =</span> crop_y, </span>
<span id="cb1-1435"><a href="#cb1-1435" aria-hidden="true" tabindex="-1"></a>             <span class="at">expand =</span> T) <span class="sc">+</span></span>
<span id="cb1-1436"><a href="#cb1-1436" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_colorbar</span>(</span>
<span id="cb1-1437"><a href="#cb1-1437" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Sea Surface Temperature Anomaly \u00b0C"</span>,</span>
<span id="cb1-1438"><a href="#cb1-1438" aria-hidden="true" tabindex="-1"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb1-1439"><a href="#cb1-1439" aria-hidden="true" tabindex="-1"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1440"><a href="#cb1-1440" aria-hidden="true" tabindex="-1"></a>      <span class="at">barwidth =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"in"</span>),</span>
<span id="cb1-1441"><a href="#cb1-1441" aria-hidden="true" tabindex="-1"></a>      <span class="at">frame.colour =</span> <span class="st">"black"</span>,</span>
<span id="cb1-1442"><a href="#cb1-1442" aria-hidden="true" tabindex="-1"></a>      <span class="at">ticks.colour =</span> <span class="st">"black"</span>)) </span>
<span id="cb1-1443"><a href="#cb1-1443" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1444"><a href="#cb1-1444" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set colors by name</span></span>
<span id="cb1-1445"><a href="#cb1-1445" aria-hidden="true" tabindex="-1"></a>  color_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-1446"><a href="#cb1-1446" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sea Surface Temperature"</span> <span class="ot">=</span> <span class="st">"royalblue"</span>,</span>
<span id="cb1-1447"><a href="#cb1-1447" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Heatwave Event"</span>          <span class="ot">=</span> <span class="st">"darkred"</span>,</span>
<span id="cb1-1448"><a href="#cb1-1448" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MHW Threshold"</span>           <span class="ot">=</span> <span class="st">"coral3"</span>,</span>
<span id="cb1-1449"><a href="#cb1-1449" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Daily Climatology"</span>        <span class="ot">=</span> <span class="st">"gray30"</span>)</span>
<span id="cb1-1450"><a href="#cb1-1450" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1451"><a href="#cb1-1451" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1452"><a href="#cb1-1452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1453"><a href="#cb1-1453" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### 2.  Plot the day and the overall anomaly to track dates</span></span>
<span id="cb1-1454"><a href="#cb1-1454" aria-hidden="true" tabindex="-1"></a>  date_timeline <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> hw_timeline, <span class="fu">aes</span>(<span class="at">x =</span> time)) <span class="sc">+</span></span>
<span id="cb1-1455"><a href="#cb1-1455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sst, <span class="at">color =</span> <span class="st">"Sea Surface Temperature"</span>)) <span class="sc">+</span></span>
<span id="cb1-1456"><a href="#cb1-1456" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> hwe, <span class="at">color =</span> <span class="st">"Heatwave Event"</span>)) <span class="sc">+</span></span>
<span id="cb1-1457"><a href="#cb1-1457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> cse, <span class="at">color =</span> <span class="st">"Cold Spell Event"</span>)) <span class="sc">+</span></span>
<span id="cb1-1458"><a href="#cb1-1458" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mhw_thresh, <span class="at">color =</span> <span class="st">"MHW Threshold"</span>), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-1459"><a href="#cb1-1459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> mcs_thresh, <span class="at">color =</span> <span class="st">"MCS Threshold"</span>), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-1460"><a href="#cb1-1460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> seas, <span class="at">color =</span> <span class="st">"Daily Climatology"</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1-1461"><a href="#cb1-1461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> color_vals) <span class="sc">+</span></span>
<span id="cb1-1462"><a href="#cb1-1462" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-1463"><a href="#cb1-1463" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Animated Point /  line</span></span>
<span id="cb1-1464"><a href="#cb1-1464" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb1-1465"><a href="#cb1-1465" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> <span class="fu">filter</span>(hw_timeline, time <span class="sc">==</span> <span class="fu">as.Date</span>(date_label)),</span>
<span id="cb1-1466"><a href="#cb1-1466" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(time, sst, <span class="at">shape =</span> <span class="fu">factor</span>(mhw_event)), </span>
<span id="cb1-1467"><a href="#cb1-1467" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>), </span>
<span id="cb1-1468"><a href="#cb1-1468" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">3</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb1-1469"><a href="#cb1-1469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">data =</span> <span class="fu">filter</span>(hw_timeline, time <span class="sc">==</span> <span class="fu">as.Date</span>(date_label)),</span>
<span id="cb1-1470"><a href="#cb1-1470" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xintercept =</span> time), </span>
<span id="cb1-1471"><a href="#cb1-1471" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>, </span>
<span id="cb1-1472"><a href="#cb1-1472" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1473"><a href="#cb1-1473" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="dv">3</span>,</span>
<span id="cb1-1474"><a href="#cb1-1474" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb1-1475"><a href="#cb1-1475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-1476"><a href="#cb1-1476" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb1-1477"><a href="#cb1-1477" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">""</span>,</span>
<span id="cb1-1478"><a href="#cb1-1478" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Regional Temperature \u00b0C"</span>,</span>
<span id="cb1-1479"><a href="#cb1-1479" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="st">"Heatwave Event"</span>) <span class="sc">+</span></span>
<span id="cb1-1480"><a href="#cb1-1480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb1-1481"><a href="#cb1-1481" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1482"><a href="#cb1-1482" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1483"><a href="#cb1-1483" aria-hidden="true" tabindex="-1"></a>  <span class="do">####  3. Assemble plot(s)</span></span>
<span id="cb1-1484"><a href="#cb1-1484" aria-hidden="true" tabindex="-1"></a>  p_layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-1485"><a href="#cb1-1485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">8</span>),</span>
<span id="cb1-1486"><a href="#cb1-1486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">area</span>(<span class="at">t =</span> <span class="dv">3</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">8</span>, <span class="at">r =</span> <span class="dv">8</span>))</span>
<span id="cb1-1487"><a href="#cb1-1487" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1488"><a href="#cb1-1488" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot_agg &lt;- (date_timeline / day_plot) + plot_layout(heights = c(1, 3))</span></span>
<span id="cb1-1489"><a href="#cb1-1489" aria-hidden="true" tabindex="-1"></a>  plot_agg <span class="ot">&lt;-</span> date_timeline <span class="sc">+</span> day_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">design =</span> p_layout)</span>
<span id="cb1-1490"><a href="#cb1-1490" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1491"><a href="#cb1-1491" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1492"><a href="#cb1-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot_agg )</span>
<span id="cb1-1493"><a href="#cb1-1493" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1494"><a href="#cb1-1494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-1495"><a href="#cb1-1495" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-1496"><a href="#cb1-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1497"><a href="#cb1-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1498"><a href="#cb1-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(day_plots, print)</span>
<span id="cb1-1499"><a href="#cb1-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1500"><a href="#cb1-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1501"><a href="#cb1-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1502"><a href="#cb1-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1503"><a href="#cb1-1503" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1504"><a href="#cb1-1504" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-1505"><a href="#cb1-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1506"><a href="#cb1-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1507"><a href="#cb1-1507" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5: Ranking Warming Rates</span></span>
<span id="cb1-1508"><a href="#cb1-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1509"><a href="#cb1-1509" aria-hidden="true" tabindex="-1"></a>If we look at the rates of change from 1982-2021 for each grid cell, rather than the observed temperature, it is possible to rank how hot each location on earth is warming relative to all the others.</span>
<span id="cb1-1510"><a href="#cb1-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1511"><a href="#cb1-1511" aria-hidden="true" tabindex="-1"></a>Once we have the rankings, we can then take the average ranking within the Gulf of Maine we can obtain the average warming rank for the area compared to the rest of the globe.</span>
<span id="cb1-1512"><a href="#cb1-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1513"><a href="#cb1-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1514"><a href="#cb1-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load warming rates}</span></span>
<span id="cb1-1515"><a href="#cb1-1515" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Warming Rates and Rankings</span></span>
<span id="cb1-1516"><a href="#cb1-1516" aria-hidden="true" tabindex="-1"></a>rates_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(oisst_path, <span class="st">"warming_rates/annual_warming_rates"</span>)</span>
<span id="cb1-1517"><a href="#cb1-1517" aria-hidden="true" tabindex="-1"></a>rates_stack_all <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">str_c</span>(rates_path, <span class="st">"1982to2021.nc"</span>), </span>
<span id="cb1-1518"><a href="#cb1-1518" aria-hidden="true" tabindex="-1"></a>                         <span class="at">varname =</span> <span class="st">"annual_warming_rate"</span>)</span>
<span id="cb1-1519"><a href="#cb1-1519" aria-hidden="true" tabindex="-1"></a>ranks_stack_all <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">str_c</span>(rates_path, <span class="st">"1982to2021.nc"</span>), </span>
<span id="cb1-1520"><a href="#cb1-1520" aria-hidden="true" tabindex="-1"></a>                         <span class="at">varname =</span> <span class="st">"rate_percentile"</span>)</span>
<span id="cb1-1521"><a href="#cb1-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1522"><a href="#cb1-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1523"><a href="#cb1-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1524"><a href="#cb1-1524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1525"><a href="#cb1-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1526"><a href="#cb1-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1527"><a href="#cb1-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1528"><a href="#cb1-1528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mask warming rates}</span></span>
<span id="cb1-1529"><a href="#cb1-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1530"><a href="#cb1-1530" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the rank information that go with the original extent used by the timelines</span></span>
<span id="cb1-1531"><a href="#cb1-1531" aria-hidden="true" tabindex="-1"></a>ranks_masked <span class="ot">&lt;-</span> <span class="fu">mask_nc</span>(ranks_stack_all, region_extent)</span>
<span id="cb1-1532"><a href="#cb1-1532" aria-hidden="true" tabindex="-1"></a>rates_masked <span class="ot">&lt;-</span> <span class="fu">mask_nc</span>(rates_stack_all, region_extent)</span>
<span id="cb1-1533"><a href="#cb1-1533" aria-hidden="true" tabindex="-1"></a>region_ranks <span class="ot">&lt;-</span> <span class="fu">get_masked_vals</span>(ranks_masked, rates_masked)</span>
<span id="cb1-1534"><a href="#cb1-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1535"><a href="#cb1-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># Prep it for text input.</span></span>
<span id="cb1-1536"><a href="#cb1-1536" aria-hidden="true" tabindex="-1"></a>avg_rank <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Mean Rank</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-1537"><a href="#cb1-1537" aria-hidden="true" tabindex="-1"></a>avg_rate <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Mean Rate</span><span class="st">`</span></span>
<span id="cb1-1538"><a href="#cb1-1538" aria-hidden="true" tabindex="-1"></a>low_rank <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Min Rank</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-1539"><a href="#cb1-1539" aria-hidden="true" tabindex="-1"></a>low_rate <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Min Rate</span><span class="st">`</span></span>
<span id="cb1-1540"><a href="#cb1-1540" aria-hidden="true" tabindex="-1"></a>top_rank <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Max Rank</span><span class="st">`</span> <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-1541"><a href="#cb1-1541" aria-hidden="true" tabindex="-1"></a>top_rank <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(top_rank <span class="sc">==</span> <span class="dv">100</span>, <span class="st">"greater than or equal to 99.5"</span>, top_rank)</span>
<span id="cb1-1542"><a href="#cb1-1542" aria-hidden="true" tabindex="-1"></a>top_rate <span class="ot">&lt;-</span> region_ranks<span class="sc">$</span><span class="st">`</span><span class="at">Max Rate</span><span class="st">`</span></span>
<span id="cb1-1543"><a href="#cb1-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1544"><a href="#cb1-1544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1545"><a href="#cb1-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1546"><a href="#cb1-1546" aria-hidden="true" tabindex="-1"></a>Based on data from 1982-2021, the warming rates of <span class="in">`r tidy_name`</span> have been some of the highest in the world. The area as a whole has been increasing at a rate of <span class="in">`r avg_rate`</span>$^{\circ}C/year$ which is faster than <span class="in">`r avg_rank`</span>% of the world's oceans. </span>
<span id="cb1-1547"><a href="#cb1-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1548"><a href="#cb1-1548" aria-hidden="true" tabindex="-1"></a>Over that same period locations within the <span class="in">`r tidy_name`</span> have been warming at rates as low as <span class="in">`r low_rate`</span>$^{\circ}C/year$ and as rapidly as <span class="in">`r top_rate`</span>$^{\circ}C/year$, corresponding to ranks as low as <span class="in">`r low_rank`</span>% and as high as <span class="in">`r top_rank`</span>%.</span>
<span id="cb1-1549"><a href="#cb1-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1550"><a href="#cb1-1550" aria-hidden="true" tabindex="-1"></a>Mapped below are the corresponding warming rates and their global rankings.</span>
<span id="cb1-1551"><a href="#cb1-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1554"><a href="#cb1-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1555"><a href="#cb1-1555" aria-hidden="true" tabindex="-1"></a><span class="co"># For the full map  we mask again, but zoom out a little</span></span>
<span id="cb1-1556"><a href="#cb1-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1557"><a href="#cb1-1557" aria-hidden="true" tabindex="-1"></a><span class="co"># Mask again using the expanded mask so we can zoom out</span></span>
<span id="cb1-1558"><a href="#cb1-1558" aria-hidden="true" tabindex="-1"></a>ranks_masked <span class="ot">&lt;-</span> <span class="fu">mask_nc</span>(ranks_stack_all, region_extent_expanded)</span>
<span id="cb1-1559"><a href="#cb1-1559" aria-hidden="true" tabindex="-1"></a>rates_masked <span class="ot">&lt;-</span> <span class="fu">mask_nc</span>(rates_stack_all, region_extent_expanded)</span>
<span id="cb1-1560"><a href="#cb1-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1561"><a href="#cb1-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1562"><a href="#cb1-1562" aria-hidden="true" tabindex="-1"></a><span class="co"># Make stars object</span></span>
<span id="cb1-1563"><a href="#cb1-1563" aria-hidden="true" tabindex="-1"></a>rank_stars <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(ranks_masked)</span>
<span id="cb1-1564"><a href="#cb1-1564" aria-hidden="true" tabindex="-1"></a>rates_stars <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(rates_masked)</span>
<span id="cb1-1565"><a href="#cb1-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1566"><a href="#cb1-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1567"><a href="#cb1-1567" aria-hidden="true" tabindex="-1"></a><span class="fu">### Warming Rates</span></span>
<span id="cb1-1568"><a href="#cb1-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1571"><a href="#cb1-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1572"><a href="#cb1-1572" aria-hidden="true" tabindex="-1"></a><span class="do">####  Rates Map  ####</span></span>
<span id="cb1-1573"><a href="#cb1-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1574"><a href="#cb1-1574" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Contours if desired</span></span>
<span id="cb1-1575"><a href="#cb1-1575" aria-hidden="true" tabindex="-1"></a><span class="co"># rates_contour &lt;-  st_contour(x = rates_stars, na.rm = T, breaks = seq(0.85, 1, by = 0.02))</span></span>
<span id="cb1-1576"><a href="#cb1-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1577"><a href="#cb1-1577" aria-hidden="true" tabindex="-1"></a><span class="co"># # rates map Original</span></span>
<span id="cb1-1578"><a href="#cb1-1578" aria-hidden="true" tabindex="-1"></a><span class="co"># rates_map &lt;- ggplot() +</span></span>
<span id="cb1-1579"><a href="#cb1-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_stars(data = rates_stars) +</span></span>
<span id="cb1-1580"><a href="#cb1-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = new_england, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1581"><a href="#cb1-1581" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = canada, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1582"><a href="#cb1-1582" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = greenland, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1583"><a href="#cb1-1583" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = region_extent, </span></span>
<span id="cb1-1584"><a href="#cb1-1584" aria-hidden="true" tabindex="-1"></a><span class="co">#           color = "black", </span></span>
<span id="cb1-1585"><a href="#cb1-1585" aria-hidden="true" tabindex="-1"></a><span class="co">#           fill = "transparent", linetype = 2, size = 0.5) +</span></span>
<span id="cb1-1586"><a href="#cb1-1586" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_viridis_c(option = "plasma", na.value = "transparent") +</span></span>
<span id="cb1-1587"><a href="#cb1-1587" aria-hidden="true" tabindex="-1"></a><span class="co">#   map_theme() +</span></span>
<span id="cb1-1588"><a href="#cb1-1588" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_sf(xlim = crop_x, </span></span>
<span id="cb1-1589"><a href="#cb1-1589" aria-hidden="true" tabindex="-1"></a><span class="co">#            ylim = crop_y, expand = F) +</span></span>
<span id="cb1-1590"><a href="#cb1-1590" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides("fill" = guide_colorbar(</span></span>
<span id="cb1-1591"><a href="#cb1-1591" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Annual Temperature Change \u00b0C/year",</span></span>
<span id="cb1-1592"><a href="#cb1-1592" aria-hidden="true" tabindex="-1"></a><span class="co">#     title.position = "top", </span></span>
<span id="cb1-1593"><a href="#cb1-1593" aria-hidden="true" tabindex="-1"></a><span class="co">#     title.hjust = 0.5,</span></span>
<span id="cb1-1594"><a href="#cb1-1594" aria-hidden="true" tabindex="-1"></a><span class="co">#     barwidth = unit(2.5, "in"),</span></span>
<span id="cb1-1595"><a href="#cb1-1595" aria-hidden="true" tabindex="-1"></a><span class="co">#     frame.colour = "black",</span></span>
<span id="cb1-1596"><a href="#cb1-1596" aria-hidden="true" tabindex="-1"></a><span class="co">#     ticks.colour = "black"))</span></span>
<span id="cb1-1597"><a href="#cb1-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1598"><a href="#cb1-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1599"><a href="#cb1-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1600"><a href="#cb1-1600" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the spread</span></span>
<span id="cb1-1601"><a href="#cb1-1601" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(rates_stars$Annual.Sea.Surface.Temperature.Warming.Rate)</span></span>
<span id="cb1-1602"><a href="#cb1-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1603"><a href="#cb1-1603" aria-hidden="true" tabindex="-1"></a><span class="co"># Reclassify to discrete bins</span></span>
<span id="cb1-1604"><a href="#cb1-1604" aria-hidden="true" tabindex="-1"></a>rates_reclass <span class="ot">&lt;-</span> rates_stars <span class="sc">%&gt;%</span> </span>
<span id="cb1-1605"><a href="#cb1-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-1606"><a href="#cb1-1606" aria-hidden="true" tabindex="-1"></a>    <span class="at">warm_rate =</span> Annual.Sea.Surface.Temperature.Warming.Rate,</span>
<span id="cb1-1607"><a href="#cb1-1607" aria-hidden="true" tabindex="-1"></a>    <span class="at">rates_reclass =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-1608"><a href="#cb1-1608" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">09</span>  <span class="sc">~</span> <span class="st">"&gt; 0.1"</span>, </span>
<span id="cb1-1609"><a href="#cb1-1609" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">08</span> <span class="sc">~</span> <span class="st">"0.08 - 0.1"</span>, </span>
<span id="cb1-1610"><a href="#cb1-1610" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">06</span> <span class="sc">~</span> <span class="st">"0.06 - 0.08"</span>, </span>
<span id="cb1-1611"><a href="#cb1-1611" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">04</span> <span class="sc">~</span> <span class="st">"0.05 - 0.06"</span>, </span>
<span id="cb1-1612"><a href="#cb1-1612" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">04</span> <span class="sc">~</span> <span class="st">"0.04 - 0.05"</span>, </span>
<span id="cb1-1613"><a href="#cb1-1613" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&gt;</span> .<span class="dv">02</span> <span class="sc">~</span> <span class="st">"0.02 - 0.04"</span>, </span>
<span id="cb1-1614"><a href="#cb1-1614" aria-hidden="true" tabindex="-1"></a>      warm_rate <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"&lt; 0.02"</span>,</span>
<span id="cb1-1615"><a href="#cb1-1615" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb1-1616"><a href="#cb1-1616" aria-hidden="true" tabindex="-1"></a>    <span class="at">rates_reclass =</span> <span class="fu">factor</span>(rates_reclass, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb1-1617"><a href="#cb1-1617" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&gt; 0.1"</span>, <span class="st">"0.08 - 0.1"</span>, </span>
<span id="cb1-1618"><a href="#cb1-1618" aria-hidden="true" tabindex="-1"></a>      <span class="st">"0.06 - 0.08"</span>, <span class="st">"0.05 - 0.06"</span>, <span class="st">"0.04 - 0.05"</span>, </span>
<span id="cb1-1619"><a href="#cb1-1619" aria-hidden="true" tabindex="-1"></a>      <span class="st">"0.02 - 0.04"</span>, <span class="st">"&lt; 0.02"</span>,</span>
<span id="cb1-1620"><a href="#cb1-1620" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Outside Area Measured"</span>))</span>
<span id="cb1-1621"><a href="#cb1-1621" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(rates_reclass)</span>
<span id="cb1-1622"><a href="#cb1-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1623"><a href="#cb1-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1624"><a href="#cb1-1624" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing discrete scales</span></span>
<span id="cb1-1625"><a href="#cb1-1625" aria-hidden="true" tabindex="-1"></a>rates_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1626"><a href="#cb1-1626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stars</span>(<span class="at">data =</span> rates_reclass) <span class="sc">+</span></span>
<span id="cb1-1627"><a href="#cb1-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> new_england, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1628"><a href="#cb1-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> canada, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1629"><a href="#cb1-1629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> greenland, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1630"><a href="#cb1-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_union</span>(region_extent), </span>
<span id="cb1-1631"><a href="#cb1-1631" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1632"><a href="#cb1-1632" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-1633"><a href="#cb1-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, </span>
<span id="cb1-1634"><a href="#cb1-1634" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1635"><a href="#cb1-1635" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.translate =</span> F,</span>
<span id="cb1-1636"><a href="#cb1-1636" aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-1637"><a href="#cb1-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> crop_x, </span>
<span id="cb1-1638"><a href="#cb1-1638" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> crop_y, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1639"><a href="#cb1-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-1640"><a href="#cb1-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_legend</span>(</span>
<span id="cb1-1641"><a href="#cb1-1641" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual Temperature Change \u00b0C/year"</span>,</span>
<span id="cb1-1642"><a href="#cb1-1642" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb1-1643"><a href="#cb1-1643" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1644"><a href="#cb1-1644" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb1-1645"><a href="#cb1-1645" aria-hidden="true" tabindex="-1"></a>    <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb1-1646"><a href="#cb1-1646" aria-hidden="true" tabindex="-1"></a>    <span class="at">reverse =</span> T,</span>
<span id="cb1-1647"><a href="#cb1-1647" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb1-1648"><a href="#cb1-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1649"><a href="#cb1-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1650"><a href="#cb1-1650" aria-hidden="true" tabindex="-1"></a>rates_map</span>
<span id="cb1-1651"><a href="#cb1-1651" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.raster</span>(lab_logo, <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="fl">0.03</span>, <span class="at">just =</span> <span class="fu">c</span>(<span class="st">'left'</span>, <span class="st">'bottom'</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">'inches'</span>))</span>
<span id="cb1-1652"><a href="#cb1-1652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1653"><a href="#cb1-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1654"><a href="#cb1-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1655"><a href="#cb1-1655" aria-hidden="true" tabindex="-1"></a><span class="fu">### Warming Ranks</span></span>
<span id="cb1-1656"><a href="#cb1-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1659"><a href="#cb1-1659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1660"><a href="#cb1-1660" aria-hidden="true" tabindex="-1"></a><span class="do">####  Warming Ranks Map  ####</span></span>
<span id="cb1-1661"><a href="#cb1-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1662"><a href="#cb1-1662" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Contours if desired</span></span>
<span id="cb1-1663"><a href="#cb1-1663" aria-hidden="true" tabindex="-1"></a>ranks_contour <span class="ot">&lt;-</span>  <span class="fu">st_contour</span>(<span class="at">x =</span> rank_stars, <span class="at">na.rm =</span> T, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.85</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.02</span>))</span>
<span id="cb1-1664"><a href="#cb1-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1665"><a href="#cb1-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1666"><a href="#cb1-1666" aria-hidden="true" tabindex="-1"></a><span class="co"># # Original Map</span></span>
<span id="cb1-1667"><a href="#cb1-1667" aria-hidden="true" tabindex="-1"></a><span class="co"># # ranks map</span></span>
<span id="cb1-1668"><a href="#cb1-1668" aria-hidden="true" tabindex="-1"></a><span class="co"># ranks_map &lt;- ggplot() +</span></span>
<span id="cb1-1669"><a href="#cb1-1669" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_stars(data = rank_stars) +</span></span>
<span id="cb1-1670"><a href="#cb1-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = ranks_contour, fill = "transparent", color = "gray30", size = 0.1) +</span></span>
<span id="cb1-1671"><a href="#cb1-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = new_england, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1672"><a href="#cb1-1672" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = canada, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1673"><a href="#cb1-1673" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = greenland, fill = "gray90", size = .25) +</span></span>
<span id="cb1-1674"><a href="#cb1-1674" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = region_extent, </span></span>
<span id="cb1-1675"><a href="#cb1-1675" aria-hidden="true" tabindex="-1"></a><span class="co">#           color = "black", </span></span>
<span id="cb1-1676"><a href="#cb1-1676" aria-hidden="true" tabindex="-1"></a><span class="co">#           fill = "transparent", linetype = 2, size = 0.5) +</span></span>
<span id="cb1-1677"><a href="#cb1-1677" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_viridis_c(option = "plasma",</span></span>
<span id="cb1-1678"><a href="#cb1-1678" aria-hidden="true" tabindex="-1"></a><span class="co">#                        na.value = "transparent",</span></span>
<span id="cb1-1679"><a href="#cb1-1679" aria-hidden="true" tabindex="-1"></a><span class="co">#                        limit = c(0.85, 1),</span></span>
<span id="cb1-1680"><a href="#cb1-1680" aria-hidden="true" tabindex="-1"></a><span class="co">#                        oob = scales::oob_squish) +</span></span>
<span id="cb1-1681"><a href="#cb1-1681" aria-hidden="true" tabindex="-1"></a><span class="co">#  map_theme() +</span></span>
<span id="cb1-1682"><a href="#cb1-1682" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_sf(xlim = crop_x, </span></span>
<span id="cb1-1683"><a href="#cb1-1683" aria-hidden="true" tabindex="-1"></a><span class="co">#            ylim = crop_y, expand = F) +</span></span>
<span id="cb1-1684"><a href="#cb1-1684" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides("fill" = guide_colorbar(</span></span>
<span id="cb1-1685"><a href="#cb1-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Global Percentile of Warming Rates",</span></span>
<span id="cb1-1686"><a href="#cb1-1686" aria-hidden="true" tabindex="-1"></a><span class="co">#     title.position = "top", </span></span>
<span id="cb1-1687"><a href="#cb1-1687" aria-hidden="true" tabindex="-1"></a><span class="co">#     title.hjust = 0.5,</span></span>
<span id="cb1-1688"><a href="#cb1-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#     barwidth = unit(2.5, "in"),</span></span>
<span id="cb1-1689"><a href="#cb1-1689" aria-hidden="true" tabindex="-1"></a><span class="co">#     frame.colour = "black",</span></span>
<span id="cb1-1690"><a href="#cb1-1690" aria-hidden="true" tabindex="-1"></a><span class="co">#     ticks.colour = "black")) +</span></span>
<span id="cb1-1691"><a href="#cb1-1691" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(caption = "Ranking color scale truncated to display ranges of 0.85-1 </span></span>
<span id="cb1-1692"><a href="#cb1-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Lower values will display as 0.85 or 85%</span></span>
<span id="cb1-1693"><a href="#cb1-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Contour values every 2%")</span></span>
<span id="cb1-1694"><a href="#cb1-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1695"><a href="#cb1-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1696"><a href="#cb1-1696" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the spread</span></span>
<span id="cb1-1697"><a href="#cb1-1697" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(rank_stars$Annual.Sea.Surface.Temperature.Warming.Rate.Rank)</span></span>
<span id="cb1-1698"><a href="#cb1-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1699"><a href="#cb1-1699" aria-hidden="true" tabindex="-1"></a><span class="co"># reclassify to discrete bins</span></span>
<span id="cb1-1700"><a href="#cb1-1700" aria-hidden="true" tabindex="-1"></a>ranks_reclass <span class="ot">&lt;-</span> rank_stars <span class="sc">%&gt;%</span> </span>
<span id="cb1-1701"><a href="#cb1-1701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-1702"><a href="#cb1-1702" aria-hidden="true" tabindex="-1"></a>    <span class="at">warm_rank =</span> Annual.Sea.Surface.Temperature.Warming.Rate.Rank,</span>
<span id="cb1-1703"><a href="#cb1-1703" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranks_class =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-1704"><a href="#cb1-1704" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">999</span>  <span class="sc">~</span> <span class="st">"&gt; 99.9%"</span>, </span>
<span id="cb1-1705"><a href="#cb1-1705" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">99</span>  <span class="sc">~</span> <span class="st">"99 - 99.9%"</span>, </span>
<span id="cb1-1706"><a href="#cb1-1706" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">98</span> <span class="sc">~</span> <span class="st">"98 - 99%"</span>, </span>
<span id="cb1-1707"><a href="#cb1-1707" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">95</span> <span class="sc">~</span> <span class="st">"95 - 98%"</span>, </span>
<span id="cb1-1708"><a href="#cb1-1708" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">90</span> <span class="sc">~</span> <span class="st">"90 - 95%"</span>, </span>
<span id="cb1-1709"><a href="#cb1-1709" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&gt;</span> .<span class="dv">80</span> <span class="sc">~</span> <span class="st">"80 - 90%"</span>, </span>
<span id="cb1-1710"><a href="#cb1-1710" aria-hidden="true" tabindex="-1"></a>      warm_rank <span class="sc">&lt;</span> .<span class="dv">80</span> <span class="sc">~</span> <span class="st">"&lt; 80%"</span>,</span>
<span id="cb1-1711"><a href="#cb1-1711" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb1-1712"><a href="#cb1-1712" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranks_class =</span> <span class="fu">factor</span>(ranks_class, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb1-1713"><a href="#cb1-1713" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&gt; 99.9%"</span>, <span class="st">"99 - 99.9%"</span>, <span class="st">"98 - 99%"</span>, </span>
<span id="cb1-1714"><a href="#cb1-1714" aria-hidden="true" tabindex="-1"></a>      <span class="st">"95 - 98%"</span>, <span class="st">"90 - 95%"</span>, </span>
<span id="cb1-1715"><a href="#cb1-1715" aria-hidden="true" tabindex="-1"></a>      <span class="st">"80 - 90%"</span>, <span class="st">"&lt; 80%"</span>))</span>
<span id="cb1-1716"><a href="#cb1-1716" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ranks_class)</span>
<span id="cb1-1717"><a href="#cb1-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1718"><a href="#cb1-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1719"><a href="#cb1-1719" aria-hidden="true" tabindex="-1"></a>ranks_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-1720"><a href="#cb1-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stars</span>(<span class="at">data =</span> ranks_reclass) <span class="sc">+</span></span>
<span id="cb1-1721"><a href="#cb1-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> new_england, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1722"><a href="#cb1-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> canada, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1723"><a href="#cb1-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> greenland, <span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb1-1724"><a href="#cb1-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_union</span>(region_extent), </span>
<span id="cb1-1725"><a href="#cb1-1725" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb1-1726"><a href="#cb1-1726" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-1727"><a href="#cb1-1727" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>, </span>
<span id="cb1-1728"><a href="#cb1-1728" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="st">"transparent"</span>, </span>
<span id="cb1-1729"><a href="#cb1-1729" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.translate =</span> F,</span>
<span id="cb1-1730"><a href="#cb1-1730" aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-1731"><a href="#cb1-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-1732"><a href="#cb1-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> crop_x, </span>
<span id="cb1-1733"><a href="#cb1-1733" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> crop_y, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb1-1734"><a href="#cb1-1734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="st">"fill"</span> <span class="ot">=</span> <span class="fu">guide_legend</span>(</span>
<span id="cb1-1735"><a href="#cb1-1735" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Global Percentile of Warming Rates"</span>,</span>
<span id="cb1-1736"><a href="#cb1-1736" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb1-1737"><a href="#cb1-1737" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1738"><a href="#cb1-1738" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb1-1739"><a href="#cb1-1739" aria-hidden="true" tabindex="-1"></a>    <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb1-1740"><a href="#cb1-1740" aria-hidden="true" tabindex="-1"></a>    <span class="at">reverse =</span> T,</span>
<span id="cb1-1741"><a href="#cb1-1741" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-1742"><a href="#cb1-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Pixels ranked globally based on annual warming rate."</span>)</span>
<span id="cb1-1743"><a href="#cb1-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1744"><a href="#cb1-1744" aria-hidden="true" tabindex="-1"></a><span class="co"># plot both</span></span>
<span id="cb1-1745"><a href="#cb1-1745" aria-hidden="true" tabindex="-1"></a>ranks_map</span>
<span id="cb1-1746"><a href="#cb1-1746" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.raster</span>(lab_logo, <span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="fl">0.03</span>, <span class="at">just =</span> <span class="fu">c</span>(<span class="st">'left'</span>, <span class="st">'bottom'</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">'inches'</span>))</span>
<span id="cb1-1747"><a href="#cb1-1747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1748"><a href="#cb1-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1749"><a href="#cb1-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1750"><a href="#cb1-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1751"><a href="#cb1-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1752"><a href="#cb1-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1753"><a href="#cb1-1753" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6: Shifting Baselines</span></span>
<span id="cb1-1754"><a href="#cb1-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1755"><a href="#cb1-1755" aria-hidden="true" tabindex="-1"></a>In 2021 NOAA is transitioning standard climatologies from the 30-year period of 1982-2011 to a new period spanning 1992-2020. Changes in climate regimes often does not result in a uniform upward or downward change that is consistent throughout the year. </span>
<span id="cb1-1756"><a href="#cb1-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1757"><a href="#cb1-1757" aria-hidden="true" tabindex="-1"></a>The plot below shows just how both the average temperature, as well as the annual highs and lows have shifted. When looking specifically at <span class="in">`r tidy_name`</span> here is how the expected temperature for each day of the year has shifted.</span>
<span id="cb1-1758"><a href="#cb1-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1759"><a href="#cb1-1759" aria-hidden="true" tabindex="-1"></a>From this we can see that the Fall temperatures have risen more than those of the spring. There is also a large change in where the threshold for Marine Heatwave events sits, a consequence of exceptionally warm Fall temperatures becoming more common.</span>
<span id="cb1-1760"><a href="#cb1-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1763"><a href="#cb1-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-1764"><a href="#cb1-1764" aria-hidden="true" tabindex="-1"></a><span class="co"># Run heatwave detection using new climate period</span></span>
<span id="cb1-1765"><a href="#cb1-1765" aria-hidden="true" tabindex="-1"></a>heatwaves_91 <span class="ot">&lt;-</span> <span class="fu">pull_heatwave_events</span>(region_timeseries, </span>
<span id="cb1-1766"><a href="#cb1-1766" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">threshold =</span> <span class="dv">90</span>, </span>
<span id="cb1-1767"><a href="#cb1-1767" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">clim_ref_period =</span> <span class="fu">c</span>(<span class="st">"1991-01-01"</span>, <span class="st">"2020-12-31"</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb1-1768"><a href="#cb1-1768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">supplement_hw_data</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-1769"><a href="#cb1-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(doy <span class="sc">!=</span> <span class="dv">366</span>)</span>
<span id="cb1-1770"><a href="#cb1-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1771"><a href="#cb1-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1772"><a href="#cb1-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1773"><a href="#cb1-1773" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtract old from the new</span></span>
<span id="cb1-1774"><a href="#cb1-1774" aria-hidden="true" tabindex="-1"></a>heatwaves_91 <span class="ot">&lt;-</span> heatwaves_91 <span class="sc">%&gt;%</span> </span>
<span id="cb1-1775"><a href="#cb1-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clim_shift =</span> seas <span class="sc">-</span> region_hw<span class="sc">$</span>seas,</span>
<span id="cb1-1776"><a href="#cb1-1776" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper_shift =</span> mhw_thresh <span class="sc">-</span> region_hw<span class="sc">$</span>mhw_thresh,</span>
<span id="cb1-1777"><a href="#cb1-1777" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower_shift =</span> mcs_thresh <span class="sc">-</span> region_hw<span class="sc">$</span>mcs_thresh)</span>
<span id="cb1-1778"><a href="#cb1-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1779"><a href="#cb1-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1780"><a href="#cb1-1780" aria-hidden="true" tabindex="-1"></a><span class="co"># Make arrows where we want to point at things:</span></span>
<span id="cb1-1781"><a href="#cb1-1781" aria-hidden="true" tabindex="-1"></a>arrows <span class="ot">&lt;-</span> </span>
<span id="cb1-1782"><a href="#cb1-1782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb1-1783"><a href="#cb1-1783" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2000-07-15"</span>)),</span>
<span id="cb1-1784"><a href="#cb1-1784" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2000-08-28"</span>)),</span>
<span id="cb1-1785"><a href="#cb1-1785" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">c</span>(<span class="fl">1.25</span>), </span>
<span id="cb1-1786"><a href="#cb1-1786" aria-hidden="true" tabindex="-1"></a>    <span class="at">y2 =</span> <span class="fu">c</span>(<span class="fl">1.15</span>)</span>
<span id="cb1-1787"><a href="#cb1-1787" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-1788"><a href="#cb1-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1789"><a href="#cb1-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the differences</span></span>
<span id="cb1-1790"><a href="#cb1-1790" aria-hidden="true" tabindex="-1"></a>heatwaves_91 <span class="sc">%&gt;%</span> </span>
<span id="cb1-1791"><a href="#cb1-1791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> last_year) <span class="sc">%&gt;%</span> </span>
<span id="cb1-1792"><a href="#cb1-1792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time),</span>
<span id="cb1-1793"><a href="#cb1-1793" aria-hidden="true" tabindex="-1"></a>         <span class="at">yday =</span> <span class="fu">yday</span>(time),</span>
<span id="cb1-1794"><a href="#cb1-1794" aria-hidden="true" tabindex="-1"></a>         <span class="at">flat_date =</span> <span class="fu">as.Date</span>(yday<span class="dv">-1</span>, <span class="at">origin =</span> base_date)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-1795"><a href="#cb1-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(flat_date, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span>        </span>
<span id="cb1-1796"><a href="#cb1-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> flat_date)) <span class="sc">+</span></span>
<span id="cb1-1797"><a href="#cb1-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> clim_shift, <span class="at">color =</span> <span class="st">"Mean Temperature Shift"</span>)) <span class="sc">+</span> </span>
<span id="cb1-1798"><a href="#cb1-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> upper_shift, <span class="at">color =</span> <span class="st">"MHW Threshold Change"</span>)) <span class="sc">+</span> </span>
<span id="cb1-1799"><a href="#cb1-1799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lower_shift, <span class="at">color =</span> <span class="st">"MCS Threshold Change"</span>)) <span class="sc">+</span> </span>
<span id="cb1-1800"><a href="#cb1-1800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(</span>
<span id="cb1-1801"><a href="#cb1-1801" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> arrows, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, <span class="at">xend =</span> x2, <span class="at">yend =</span> y2),</span>
<span id="cb1-1802"><a href="#cb1-1802" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.08</span>, <span class="st">"inch"</span>)), <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-1803"><a href="#cb1-1803" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray20"</span>, <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb1-1804"><a href="#cb1-1804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2000-06-01"</span>), <span class="at">y =</span> <span class="fl">1.225</span>, <span class="at">label =</span> <span class="st">"Fall Extremes</span><span class="sc">\n</span><span class="st">More Frequent"</span>) <span class="sc">+</span></span>
<span id="cb1-1805"><a href="#cb1-1805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-1806"><a href="#cb1-1806" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Shift in Expected Temperature \u00b0C"</span>,</span>
<span id="cb1-1807"><a href="#cb1-1807" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb1-1808"><a href="#cb1-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-1809"><a href="#cb1-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb1-1810"><a href="#cb1-1810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb1-1811"><a href="#cb1-1811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-1812"><a href="#cb1-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1813"><a href="#cb1-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1814"><a href="#cb1-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1815"><a href="#cb1-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1816"><a href="#cb1-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1817"><a href="#cb1-1817" aria-hidden="true" tabindex="-1"></a><span class="in">`r insert_gmri_footer()`</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>